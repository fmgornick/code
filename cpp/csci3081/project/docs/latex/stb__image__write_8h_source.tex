\hypertarget{stb__image__write_8h_source}{}\doxysection{stb\+\_\+image\+\_\+write.\+h}
\label{stb__image__write_8h_source}\index{/Users/Fletcher/csci3081/repo-\/team-\/0/project/image/include/stb\_image\_write.h@{/Users/Fletcher/csci3081/repo-\/team-\/0/project/image/include/stb\_image\_write.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/* stb\_image\_write -\/ v1.16 -\/ public domain -\/ http://nothings.org/stb}}
\DoxyCodeLine{2 \textcolor{comment}{   writes out PNG/BMP/TGA/JPEG/HDR images to C stdio -\/ Sean Barrett 2010-\/2015}}
\DoxyCodeLine{3 \textcolor{comment}{                                     no warranty implied; use at your own risk}}
\DoxyCodeLine{4 \textcolor{comment}{}}
\DoxyCodeLine{5 \textcolor{comment}{   Before \#including,}}
\DoxyCodeLine{6 \textcolor{comment}{}}
\DoxyCodeLine{7 \textcolor{comment}{       \#define STB\_IMAGE\_WRITE\_IMPLEMENTATION}}
\DoxyCodeLine{8 \textcolor{comment}{}}
\DoxyCodeLine{9 \textcolor{comment}{   in the file that you want to have the implementation.}}
\DoxyCodeLine{10 \textcolor{comment}{}}
\DoxyCodeLine{11 \textcolor{comment}{   Will probably not work correctly with strict-\/aliasing optimizations.}}
\DoxyCodeLine{12 \textcolor{comment}{}}
\DoxyCodeLine{13 \textcolor{comment}{ABOUT:}}
\DoxyCodeLine{14 \textcolor{comment}{}}
\DoxyCodeLine{15 \textcolor{comment}{   This header file is a library for writing images to C stdio or a callback.}}
\DoxyCodeLine{16 \textcolor{comment}{}}
\DoxyCodeLine{17 \textcolor{comment}{   The PNG output is not optimal; it is 20-\/50\% larger than the file}}
\DoxyCodeLine{18 \textcolor{comment}{   written by a decent optimizing implementation; though providing a custom}}
\DoxyCodeLine{19 \textcolor{comment}{   zlib compress function (see STBIW\_ZLIB\_COMPRESS) can mitigate that.}}
\DoxyCodeLine{20 \textcolor{comment}{   This library is designed for source code compactness and simplicity,}}
\DoxyCodeLine{21 \textcolor{comment}{   not optimal image file size or run-\/time performance.}}
\DoxyCodeLine{22 \textcolor{comment}{}}
\DoxyCodeLine{23 \textcolor{comment}{BUILDING:}}
\DoxyCodeLine{24 \textcolor{comment}{}}
\DoxyCodeLine{25 \textcolor{comment}{   You can \#define STBIW\_ASSERT(x) before the \#include to avoid using assert.h.}}
\DoxyCodeLine{26 \textcolor{comment}{   You can \#define STBIW\_MALLOC(), STBIW\_REALLOC(), and STBIW\_FREE() to replace}}
\DoxyCodeLine{27 \textcolor{comment}{   malloc,realloc,free.}}
\DoxyCodeLine{28 \textcolor{comment}{   You can \#define STBIW\_MEMMOVE() to replace memmove()}}
\DoxyCodeLine{29 \textcolor{comment}{   You can \#define STBIW\_ZLIB\_COMPRESS to use a custom zlib-\/style compress}}
\DoxyCodeLine{30 \textcolor{comment}{function for PNG compression (instead of the builtin one), it must have the}}
\DoxyCodeLine{31 \textcolor{comment}{following signature: unsigned char * my\_compress(unsigned char *data, int}}
\DoxyCodeLine{32 \textcolor{comment}{data\_len, int *out\_len, int quality); The returned data will be freed with}}
\DoxyCodeLine{33 \textcolor{comment}{STBIW\_FREE() (free() by default), so it must be heap allocated with}}
\DoxyCodeLine{34 \textcolor{comment}{STBIW\_MALLOC() (malloc() by default),}}
\DoxyCodeLine{35 \textcolor{comment}{}}
\DoxyCodeLine{36 \textcolor{comment}{UNICODE:}}
\DoxyCodeLine{37 \textcolor{comment}{}}
\DoxyCodeLine{38 \textcolor{comment}{   If compiling for Windows and you wish to use Unicode filenames, compile}}
\DoxyCodeLine{39 \textcolor{comment}{   with}}
\DoxyCodeLine{40 \textcolor{comment}{       \#define STBIW\_WINDOWS\_UTF8}}
\DoxyCodeLine{41 \textcolor{comment}{   and pass utf8-\/encoded filenames. Call stbiw\_convert\_wchar\_to\_utf8 to convert}}
\DoxyCodeLine{42 \textcolor{comment}{   Windows wchar\_t filenames to utf8.}}
\DoxyCodeLine{43 \textcolor{comment}{}}
\DoxyCodeLine{44 \textcolor{comment}{USAGE:}}
\DoxyCodeLine{45 \textcolor{comment}{}}
\DoxyCodeLine{46 \textcolor{comment}{   There are five functions, one for each image file format:}}
\DoxyCodeLine{47 \textcolor{comment}{}}
\DoxyCodeLine{48 \textcolor{comment}{     int stbi\_write\_png(char const *filename, int w, int h, int comp, const void}}
\DoxyCodeLine{49 \textcolor{comment}{*data, int stride\_in\_bytes); int stbi\_write\_bmp(char const *filename, int w, int}}
\DoxyCodeLine{50 \textcolor{comment}{h, int comp, const void *data); int stbi\_write\_tga(char const *filename, int w,}}
\DoxyCodeLine{51 \textcolor{comment}{int h, int comp, const void *data); int stbi\_write\_jpg(char const *filename, int}}
\DoxyCodeLine{52 \textcolor{comment}{w, int h, int comp, const void *data, int quality); int stbi\_write\_hdr(char}}
\DoxyCodeLine{53 \textcolor{comment}{const *filename, int w, int h, int comp, const float *data);}}
\DoxyCodeLine{54 \textcolor{comment}{}}
\DoxyCodeLine{55 \textcolor{comment}{     void stbi\_flip\_vertically\_on\_write(int flag); // flag is non-\/zero to flip}}
\DoxyCodeLine{56 \textcolor{comment}{data vertically}}
\DoxyCodeLine{57 \textcolor{comment}{}}
\DoxyCodeLine{58 \textcolor{comment}{   There are also five equivalent functions that use an arbitrary write}}
\DoxyCodeLine{59 \textcolor{comment}{function. You are expected to open/close your file-\/equivalent before and after}}
\DoxyCodeLine{60 \textcolor{comment}{calling these:}}
\DoxyCodeLine{61 \textcolor{comment}{}}
\DoxyCodeLine{62 \textcolor{comment}{     int stbi\_write\_png\_to\_func(stbi\_write\_func *func, void *context, int w, int}}
\DoxyCodeLine{63 \textcolor{comment}{h, int comp, const void  *data, int stride\_in\_bytes); int}}
\DoxyCodeLine{64 \textcolor{comment}{stbi\_write\_bmp\_to\_func(stbi\_write\_func *func, void *context, int w, int h, int}}
\DoxyCodeLine{65 \textcolor{comment}{comp, const void  *data); int stbi\_write\_tga\_to\_func(stbi\_write\_func *func, void}}
\DoxyCodeLine{66 \textcolor{comment}{*context, int w, int h, int comp, const void  *data); int}}
\DoxyCodeLine{67 \textcolor{comment}{stbi\_write\_hdr\_to\_func(stbi\_write\_func *func, void *context, int w, int h, int}}
\DoxyCodeLine{68 \textcolor{comment}{comp, const float *data); int stbi\_write\_jpg\_to\_func(stbi\_write\_func *func, void}}
\DoxyCodeLine{69 \textcolor{comment}{*context, int x, int y, int comp, const void *data, int quality);}}
\DoxyCodeLine{70 \textcolor{comment}{}}
\DoxyCodeLine{71 \textcolor{comment}{   where the callback is:}}
\DoxyCodeLine{72 \textcolor{comment}{      void stbi\_write\_func(void *context, void *data, int size);}}
\DoxyCodeLine{73 \textcolor{comment}{}}
\DoxyCodeLine{74 \textcolor{comment}{   You can configure it with these global variables:}}
\DoxyCodeLine{75 \textcolor{comment}{      int stbi\_write\_tga\_with\_rle;             // defaults to true; set to 0 to}}
\DoxyCodeLine{76 \textcolor{comment}{disable RLE int stbi\_write\_png\_compression\_level;    // defaults to 8; set to}}
\DoxyCodeLine{77 \textcolor{comment}{higher for more compression int stbi\_write\_force\_png\_filter;         // defaults}}
\DoxyCodeLine{78 \textcolor{comment}{to -\/1; set to 0..5 to force a filter mode}}
\DoxyCodeLine{79 \textcolor{comment}{}}
\DoxyCodeLine{80 \textcolor{comment}{}}
\DoxyCodeLine{81 \textcolor{comment}{   You can define STBI\_WRITE\_NO\_STDIO to disable the file variant of these}}
\DoxyCodeLine{82 \textcolor{comment}{   functions, so the library will not use stdio.h at all. However, this will}}
\DoxyCodeLine{83 \textcolor{comment}{   also disable HDR writing, because it requires stdio for formatted output.}}
\DoxyCodeLine{84 \textcolor{comment}{}}
\DoxyCodeLine{85 \textcolor{comment}{   Each function returns 0 on failure and non-\/0 on success.}}
\DoxyCodeLine{86 \textcolor{comment}{}}
\DoxyCodeLine{87 \textcolor{comment}{   The functions create an image file defined by the parameters. The image}}
\DoxyCodeLine{88 \textcolor{comment}{   is a rectangle of pixels stored from left-\/to-\/right, top-\/to-\/bottom.}}
\DoxyCodeLine{89 \textcolor{comment}{   Each pixel contains 'comp' channels of data stored interleaved with 8-\/bits}}
\DoxyCodeLine{90 \textcolor{comment}{   per channel, in the following order: 1=Y, 2=YA, 3=RGB, 4=RGBA. (Y is}}
\DoxyCodeLine{91 \textcolor{comment}{   monochrome color.) The rectangle is 'w' pixels wide and 'h' pixels tall.}}
\DoxyCodeLine{92 \textcolor{comment}{   The *data pointer points to the first byte of the top-\/left-\/most pixel.}}
\DoxyCodeLine{93 \textcolor{comment}{   For PNG, "{}stride\_in\_bytes"{} is the distance in bytes from the first byte of}}
\DoxyCodeLine{94 \textcolor{comment}{   a row of pixels to the first byte of the next row of pixels.}}
\DoxyCodeLine{95 \textcolor{comment}{}}
\DoxyCodeLine{96 \textcolor{comment}{   PNG creates output files with the same number of components as the input.}}
\DoxyCodeLine{97 \textcolor{comment}{   The BMP format expands Y to RGB in the file format and does not}}
\DoxyCodeLine{98 \textcolor{comment}{   output alpha.}}
\DoxyCodeLine{99 \textcolor{comment}{}}
\DoxyCodeLine{100 \textcolor{comment}{   PNG supports writing rectangles of data even when the bytes storing rows of}}
\DoxyCodeLine{101 \textcolor{comment}{   data are not consecutive in memory (e.g. sub-\/rectangles of a larger image),}}
\DoxyCodeLine{102 \textcolor{comment}{   by supplying the stride between the beginning of adjacent rows. The other}}
\DoxyCodeLine{103 \textcolor{comment}{   formats do not. (Thus you cannot write a native-\/format BMP through the BMP}}
\DoxyCodeLine{104 \textcolor{comment}{   writer, both because it is in BGR order and because it may have padding}}
\DoxyCodeLine{105 \textcolor{comment}{   at the end of the line.)}}
\DoxyCodeLine{106 \textcolor{comment}{}}
\DoxyCodeLine{107 \textcolor{comment}{   PNG allows you to set the deflate compression level by setting the global}}
\DoxyCodeLine{108 \textcolor{comment}{   variable 'stbi\_write\_png\_compression\_level' (it defaults to 8).}}
\DoxyCodeLine{109 \textcolor{comment}{}}
\DoxyCodeLine{110 \textcolor{comment}{   HDR expects linear float data. Since the format is always 32-\/bit rgb(e)}}
\DoxyCodeLine{111 \textcolor{comment}{   data, alpha (if provided) is discarded, and for monochrome data it is}}
\DoxyCodeLine{112 \textcolor{comment}{   replicated across all three channels.}}
\DoxyCodeLine{113 \textcolor{comment}{}}
\DoxyCodeLine{114 \textcolor{comment}{   TGA supports RLE or non-\/RLE compressed data. To use non-\/RLE-\/compressed}}
\DoxyCodeLine{115 \textcolor{comment}{   data, set the global variable 'stbi\_write\_tga\_with\_rle' to 0.}}
\DoxyCodeLine{116 \textcolor{comment}{}}
\DoxyCodeLine{117 \textcolor{comment}{   JPEG does ignore alpha channels in input data; quality is between 1 and 100.}}
\DoxyCodeLine{118 \textcolor{comment}{   Higher quality looks better but results in a bigger image.}}
\DoxyCodeLine{119 \textcolor{comment}{   JPEG baseline (no JPEG progressive).}}
\DoxyCodeLine{120 \textcolor{comment}{}}
\DoxyCodeLine{121 \textcolor{comment}{CREDITS:}}
\DoxyCodeLine{122 \textcolor{comment}{}}
\DoxyCodeLine{123 \textcolor{comment}{}}
\DoxyCodeLine{124 \textcolor{comment}{   Sean Barrett           -\/    PNG/BMP/TGA}}
\DoxyCodeLine{125 \textcolor{comment}{   Baldur Karlsson        -\/    HDR}}
\DoxyCodeLine{126 \textcolor{comment}{   Jean-\/Sebastien Guay    -\/    TGA monochrome}}
\DoxyCodeLine{127 \textcolor{comment}{   Tim Kelsey             -\/    misc enhancements}}
\DoxyCodeLine{128 \textcolor{comment}{   Alan Hickman           -\/    TGA RLE}}
\DoxyCodeLine{129 \textcolor{comment}{   Emmanuel Julien        -\/    initial file IO callback implementation}}
\DoxyCodeLine{130 \textcolor{comment}{   Jon Olick              -\/    original jo\_jpeg.cpp code}}
\DoxyCodeLine{131 \textcolor{comment}{   Daniel Gibson          -\/    integrate JPEG, allow external zlib}}
\DoxyCodeLine{132 \textcolor{comment}{   Aarni Koskela          -\/    allow choosing PNG filter}}
\DoxyCodeLine{133 \textcolor{comment}{}}
\DoxyCodeLine{134 \textcolor{comment}{   bugfixes:}}
\DoxyCodeLine{135 \textcolor{comment}{      github:Chribba}}
\DoxyCodeLine{136 \textcolor{comment}{      Guillaume Chereau}}
\DoxyCodeLine{137 \textcolor{comment}{      github:jry2}}
\DoxyCodeLine{138 \textcolor{comment}{      github:romigrou}}
\DoxyCodeLine{139 \textcolor{comment}{      Sergio Gonzalez}}
\DoxyCodeLine{140 \textcolor{comment}{      Jonas Karlsson}}
\DoxyCodeLine{141 \textcolor{comment}{      Filip Wasil}}
\DoxyCodeLine{142 \textcolor{comment}{      Thatcher Ulrich}}
\DoxyCodeLine{143 \textcolor{comment}{      github:poppolopoppo}}
\DoxyCodeLine{144 \textcolor{comment}{      Patrick Boettcher}}
\DoxyCodeLine{145 \textcolor{comment}{      github:xeekworx}}
\DoxyCodeLine{146 \textcolor{comment}{      Cap Petschulat}}
\DoxyCodeLine{147 \textcolor{comment}{      Simon Rodriguez}}
\DoxyCodeLine{148 \textcolor{comment}{      Ivan Tikhonov}}
\DoxyCodeLine{149 \textcolor{comment}{      github:ignotion}}
\DoxyCodeLine{150 \textcolor{comment}{      Adam Schackart}}
\DoxyCodeLine{151 \textcolor{comment}{      Andrew Kensler}}
\DoxyCodeLine{152 \textcolor{comment}{}}
\DoxyCodeLine{153 \textcolor{comment}{LICENSE}}
\DoxyCodeLine{154 \textcolor{comment}{}}
\DoxyCodeLine{155 \textcolor{comment}{  See end of file for license information.}}
\DoxyCodeLine{156 \textcolor{comment}{}}
\DoxyCodeLine{157 \textcolor{comment}{*/}}
\DoxyCodeLine{158 }
\DoxyCodeLine{159 \textcolor{preprocessor}{\#ifndef INCLUDE\_STB\_IMAGE\_WRITE\_H}}
\DoxyCodeLine{160 \textcolor{preprocessor}{\#define INCLUDE\_STB\_IMAGE\_WRITE\_H}}
\DoxyCodeLine{161 }
\DoxyCodeLine{162 \textcolor{preprocessor}{\#include <stdlib.h>}}
\DoxyCodeLine{163 }
\DoxyCodeLine{164 \textcolor{comment}{// if STB\_IMAGE\_WRITE\_STATIC causes problems, try defining STBIWDEF to 'inline'}}
\DoxyCodeLine{165 \textcolor{comment}{// or 'static inline'}}
\DoxyCodeLine{166 \textcolor{preprocessor}{\#ifndef STBIWDEF}}
\DoxyCodeLine{167 \textcolor{preprocessor}{\#ifdef STB\_IMAGE\_WRITE\_STATIC}}
\DoxyCodeLine{168 \textcolor{preprocessor}{\#define STBIWDEF static}}
\DoxyCodeLine{169 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{170 \textcolor{preprocessor}{\#ifdef \_\_cplusplus}}
\DoxyCodeLine{171 \textcolor{preprocessor}{\#define STBIWDEF extern "{}C"{}}}
\DoxyCodeLine{172 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{173 \textcolor{preprocessor}{\#define STBIWDEF extern}}
\DoxyCodeLine{174 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{175 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{176 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{177 }
\DoxyCodeLine{178 \textcolor{preprocessor}{\#ifndef STB\_IMAGE\_WRITE\_STATIC }\textcolor{comment}{// C++ forbids static forward declarations}}
\DoxyCodeLine{179 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_tga\_with\_rle;}
\DoxyCodeLine{180 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_png\_compression\_level;}
\DoxyCodeLine{181 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_force\_png\_filter;}
\DoxyCodeLine{182 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{183 }
\DoxyCodeLine{184 \textcolor{preprocessor}{\#ifndef STBI\_WRITE\_NO\_STDIO}}
\DoxyCodeLine{185 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_png(\textcolor{keywordtype}{char} \textcolor{keyword}{const} *filename, \textcolor{keywordtype}{int} w, \textcolor{keywordtype}{int} h, \textcolor{keywordtype}{int} comp,}
\DoxyCodeLine{186                             \textcolor{keyword}{const} \textcolor{keywordtype}{void} *data, \textcolor{keywordtype}{int} stride\_in\_bytes);}
\DoxyCodeLine{187 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_bmp(\textcolor{keywordtype}{char} \textcolor{keyword}{const} *filename, \textcolor{keywordtype}{int} w, \textcolor{keywordtype}{int} h, \textcolor{keywordtype}{int} comp,}
\DoxyCodeLine{188                             \textcolor{keyword}{const} \textcolor{keywordtype}{void} *data);}
\DoxyCodeLine{189 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_tga(\textcolor{keywordtype}{char} \textcolor{keyword}{const} *filename, \textcolor{keywordtype}{int} w, \textcolor{keywordtype}{int} h, \textcolor{keywordtype}{int} comp,}
\DoxyCodeLine{190                             \textcolor{keyword}{const} \textcolor{keywordtype}{void} *data);}
\DoxyCodeLine{191 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_hdr(\textcolor{keywordtype}{char} \textcolor{keyword}{const} *filename, \textcolor{keywordtype}{int} w, \textcolor{keywordtype}{int} h, \textcolor{keywordtype}{int} comp,}
\DoxyCodeLine{192                             \textcolor{keyword}{const} \textcolor{keywordtype}{float} *data);}
\DoxyCodeLine{193 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_jpg(\textcolor{keywordtype}{char} \textcolor{keyword}{const} *filename, \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp,}
\DoxyCodeLine{194                             \textcolor{keyword}{const} \textcolor{keywordtype}{void} *data, \textcolor{keywordtype}{int} quality);}
\DoxyCodeLine{195 }
\DoxyCodeLine{196 \textcolor{preprocessor}{\#ifdef STBIW\_WINDOWS\_UTF8}}
\DoxyCodeLine{197 STBIWDEF \textcolor{keywordtype}{int} stbiw\_convert\_wchar\_to\_utf8(\textcolor{keywordtype}{char} *buffer, \textcolor{keywordtype}{size\_t} bufferlen,}
\DoxyCodeLine{198                                          \textcolor{keyword}{const} \textcolor{keywordtype}{wchar\_t} *input);}
\DoxyCodeLine{199 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{200 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{201 }
\DoxyCodeLine{202 \textcolor{keyword}{typedef} \textcolor{keywordtype}{void} stbi\_write\_func(\textcolor{keywordtype}{void} *context, \textcolor{keywordtype}{void} *data, \textcolor{keywordtype}{int} size);}
\DoxyCodeLine{203 }
\DoxyCodeLine{204 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_png\_to\_func(stbi\_write\_func *func, \textcolor{keywordtype}{void} *context, \textcolor{keywordtype}{int} w,}
\DoxyCodeLine{205                                     \textcolor{keywordtype}{int} h, \textcolor{keywordtype}{int} comp, \textcolor{keyword}{const} \textcolor{keywordtype}{void} *data,}
\DoxyCodeLine{206                                     \textcolor{keywordtype}{int} stride\_in\_bytes);}
\DoxyCodeLine{207 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_bmp\_to\_func(stbi\_write\_func *func, \textcolor{keywordtype}{void} *context, \textcolor{keywordtype}{int} w,}
\DoxyCodeLine{208                                     \textcolor{keywordtype}{int} h, \textcolor{keywordtype}{int} comp, \textcolor{keyword}{const} \textcolor{keywordtype}{void} *data);}
\DoxyCodeLine{209 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_tga\_to\_func(stbi\_write\_func *func, \textcolor{keywordtype}{void} *context, \textcolor{keywordtype}{int} w,}
\DoxyCodeLine{210                                     \textcolor{keywordtype}{int} h, \textcolor{keywordtype}{int} comp, \textcolor{keyword}{const} \textcolor{keywordtype}{void} *data);}
\DoxyCodeLine{211 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_hdr\_to\_func(stbi\_write\_func *func, \textcolor{keywordtype}{void} *context, \textcolor{keywordtype}{int} w,}
\DoxyCodeLine{212                                     \textcolor{keywordtype}{int} h, \textcolor{keywordtype}{int} comp, \textcolor{keyword}{const} \textcolor{keywordtype}{float} *data);}
\DoxyCodeLine{213 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_jpg\_to\_func(stbi\_write\_func *func, \textcolor{keywordtype}{void} *context, \textcolor{keywordtype}{int} x,}
\DoxyCodeLine{214                                     \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp, \textcolor{keyword}{const} \textcolor{keywordtype}{void} *data,}
\DoxyCodeLine{215                                     \textcolor{keywordtype}{int} quality);}
\DoxyCodeLine{216 }
\DoxyCodeLine{217 STBIWDEF \textcolor{keywordtype}{void} stbi\_flip\_vertically\_on\_write(\textcolor{keywordtype}{int} flip\_boolean);}
\DoxyCodeLine{218 }
\DoxyCodeLine{219 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// INCLUDE\_STB\_IMAGE\_WRITE\_H}}
\DoxyCodeLine{220 }
\DoxyCodeLine{221 \textcolor{preprocessor}{\#ifdef STB\_IMAGE\_WRITE\_IMPLEMENTATION}}
\DoxyCodeLine{222 }
\DoxyCodeLine{223 \textcolor{preprocessor}{\#ifdef \_WIN32}}
\DoxyCodeLine{224 \textcolor{preprocessor}{\#ifndef \_CRT\_SECURE\_NO\_WARNINGS}}
\DoxyCodeLine{225 \textcolor{preprocessor}{\#define \_CRT\_SECURE\_NO\_WARNINGS}}
\DoxyCodeLine{226 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{227 \textcolor{preprocessor}{\#ifndef \_CRT\_NONSTDC\_NO\_DEPRECATE}}
\DoxyCodeLine{228 \textcolor{preprocessor}{\#define \_CRT\_NONSTDC\_NO\_DEPRECATE}}
\DoxyCodeLine{229 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{230 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{231 }
\DoxyCodeLine{232 \textcolor{preprocessor}{\#ifndef STBI\_WRITE\_NO\_STDIO}}
\DoxyCodeLine{233 \textcolor{preprocessor}{\#include <stdio.h>}}
\DoxyCodeLine{234 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// STBI\_WRITE\_NO\_STDIO}}
\DoxyCodeLine{235 }
\DoxyCodeLine{236 \textcolor{preprocessor}{\#include <math.h>}}
\DoxyCodeLine{237 \textcolor{preprocessor}{\#include <stdarg.h>}}
\DoxyCodeLine{238 \textcolor{preprocessor}{\#include <stdlib.h>}}
\DoxyCodeLine{239 \textcolor{preprocessor}{\#include <string.h>}}
\DoxyCodeLine{240 }
\DoxyCodeLine{241 \textcolor{preprocessor}{\#if defined(STBIW\_MALLOC) \&\& defined(STBIW\_FREE) \&\&                            \(\backslash\)}}
\DoxyCodeLine{242 \textcolor{preprocessor}{    (defined(STBIW\_REALLOC) || defined(STBIW\_REALLOC\_SIZED))}}
\DoxyCodeLine{243 \textcolor{comment}{// ok}}
\DoxyCodeLine{244 \textcolor{preprocessor}{\#elif !defined(STBIW\_MALLOC) \&\& !defined(STBIW\_FREE) \&\&                        \(\backslash\)}}
\DoxyCodeLine{245 \textcolor{preprocessor}{    !defined(STBIW\_REALLOC) \&\& !defined(STBIW\_REALLOC\_SIZED)}}
\DoxyCodeLine{246 \textcolor{comment}{// ok}}
\DoxyCodeLine{247 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{248 \textcolor{preprocessor}{\#error                                                                         \(\backslash\)}}
\DoxyCodeLine{249 \textcolor{preprocessor}{    "{}Must define all or none of STBIW\_MALLOC, STBIW\_FREE, and STBIW\_REALLOC (or STBIW\_REALLOC\_SIZED)."{}}}
\DoxyCodeLine{250 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{251 }
\DoxyCodeLine{252 \textcolor{preprocessor}{\#ifndef STBIW\_MALLOC}}
\DoxyCodeLine{253 \textcolor{preprocessor}{\#define STBIW\_MALLOC(sz) malloc(sz)}}
\DoxyCodeLine{254 \textcolor{preprocessor}{\#define STBIW\_REALLOC(p, newsz) realloc(p, newsz)}}
\DoxyCodeLine{255 \textcolor{preprocessor}{\#define STBIW\_FREE(p) free(p)}}
\DoxyCodeLine{256 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{257 }
\DoxyCodeLine{258 \textcolor{preprocessor}{\#ifndef STBIW\_REALLOC\_SIZED}}
\DoxyCodeLine{259 \textcolor{preprocessor}{\#define STBIW\_REALLOC\_SIZED(p, oldsz, newsz) STBIW\_REALLOC(p, newsz)}}
\DoxyCodeLine{260 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{261 }
\DoxyCodeLine{262 \textcolor{preprocessor}{\#ifndef STBIW\_MEMMOVE}}
\DoxyCodeLine{263 \textcolor{preprocessor}{\#define STBIW\_MEMMOVE(a, b, sz) memmove(a, b, sz)}}
\DoxyCodeLine{264 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{265 }
\DoxyCodeLine{266 \textcolor{preprocessor}{\#ifndef STBIW\_ASSERT}}
\DoxyCodeLine{267 \textcolor{preprocessor}{\#include <assert.h>}}
\DoxyCodeLine{268 \textcolor{preprocessor}{\#define STBIW\_ASSERT(x) assert(x)}}
\DoxyCodeLine{269 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{270 }
\DoxyCodeLine{271 \textcolor{preprocessor}{\#define STBIW\_UCHAR(x) (unsigned char)((x)\&0xff)}}
\DoxyCodeLine{272 }
\DoxyCodeLine{273 \textcolor{preprocessor}{\#ifdef STB\_IMAGE\_WRITE\_STATIC}}
\DoxyCodeLine{274 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_write\_png\_compression\_level = 8;}
\DoxyCodeLine{275 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_write\_tga\_with\_rle = 1;}
\DoxyCodeLine{276 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_write\_force\_png\_filter = -\/1;}
\DoxyCodeLine{277 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{278 \textcolor{keywordtype}{int} stbi\_write\_png\_compression\_level = 8;}
\DoxyCodeLine{279 \textcolor{keywordtype}{int} stbi\_write\_tga\_with\_rle = 1;}
\DoxyCodeLine{280 \textcolor{keywordtype}{int} stbi\_write\_force\_png\_filter = -\/1;}
\DoxyCodeLine{281 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{282 }
\DoxyCodeLine{283 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_flip\_vertically\_on\_write = 0;}
\DoxyCodeLine{284 }
\DoxyCodeLine{285 STBIWDEF \textcolor{keywordtype}{void} stbi\_flip\_vertically\_on\_write(\textcolor{keywordtype}{int} flag) \{}
\DoxyCodeLine{286   stbi\_\_flip\_vertically\_on\_write = flag;}
\DoxyCodeLine{287 \}}
\DoxyCodeLine{288 }
\DoxyCodeLine{289 \textcolor{keyword}{typedef} \textcolor{keyword}{struct }\{}
\DoxyCodeLine{290   stbi\_write\_func *func;}
\DoxyCodeLine{291   \textcolor{keywordtype}{void} *context;}
\DoxyCodeLine{292   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} buffer[64];}
\DoxyCodeLine{293   \textcolor{keywordtype}{int} buf\_used;}
\DoxyCodeLine{294 \} stbi\_\_write\_context;}
\DoxyCodeLine{295 }
\DoxyCodeLine{296 \textcolor{comment}{// initialize a callback-\/based context}}
\DoxyCodeLine{297 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_start\_write\_callbacks(stbi\_\_write\_context *s,}
\DoxyCodeLine{298                                         stbi\_write\_func *c, \textcolor{keywordtype}{void} *context) \{}
\DoxyCodeLine{299   s-\/>func = c;}
\DoxyCodeLine{300   s-\/>context = context;}
\DoxyCodeLine{301 \}}
\DoxyCodeLine{302 }
\DoxyCodeLine{303 \textcolor{preprocessor}{\#ifndef STBI\_WRITE\_NO\_STDIO}}
\DoxyCodeLine{304 }
\DoxyCodeLine{305 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_stdio\_write(\textcolor{keywordtype}{void} *context, \textcolor{keywordtype}{void} *data, \textcolor{keywordtype}{int} size) \{}
\DoxyCodeLine{306   fwrite(data, 1, size, (FILE *)context);}
\DoxyCodeLine{307 \}}
\DoxyCodeLine{308 }
\DoxyCodeLine{309 \textcolor{preprocessor}{\#if defined(\_WIN32) \&\& defined(STBIW\_WINDOWS\_UTF8)}}
\DoxyCodeLine{310 \textcolor{preprocessor}{\#ifdef \_\_cplusplus}}
\DoxyCodeLine{311 \textcolor{preprocessor}{\#define STBIW\_EXTERN extern "{}C"{}}}
\DoxyCodeLine{312 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{313 \textcolor{preprocessor}{\#define STBIW\_EXTERN extern}}
\DoxyCodeLine{314 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{315 STBIW\_EXTERN \_\_declspec(dllimport) \textcolor{keywordtype}{int} \_\_stdcall MultiByteToWideChar(}
\DoxyCodeLine{316     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} cp, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} flags, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *str, \textcolor{keywordtype}{int} cbmb,}
\DoxyCodeLine{317     \textcolor{keywordtype}{wchar\_t} *widestr, \textcolor{keywordtype}{int} cchwide);}
\DoxyCodeLine{318 STBIW\_EXTERN \_\_declspec(dllimport) \textcolor{keywordtype}{int} \_\_stdcall WideCharToMultiByte(}
\DoxyCodeLine{319     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} cp, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} flags, \textcolor{keyword}{const} \textcolor{keywordtype}{wchar\_t} *widestr, \textcolor{keywordtype}{int} cchwide,}
\DoxyCodeLine{320     \textcolor{keywordtype}{char} *str, \textcolor{keywordtype}{int} cbmb, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *defchar, \textcolor{keywordtype}{int} *used\_default);}
\DoxyCodeLine{321 }
\DoxyCodeLine{322 STBIWDEF \textcolor{keywordtype}{int} stbiw\_convert\_wchar\_to\_utf8(\textcolor{keywordtype}{char} *buffer, \textcolor{keywordtype}{size\_t} bufferlen,}
\DoxyCodeLine{323                                          \textcolor{keyword}{const} \textcolor{keywordtype}{wchar\_t} *input) \{}
\DoxyCodeLine{324   \textcolor{keywordflow}{return} WideCharToMultiByte(65001 \textcolor{comment}{/* UTF8 */}, 0, input, -\/1, buffer,}
\DoxyCodeLine{325                              (\textcolor{keywordtype}{int})bufferlen, NULL, NULL);}
\DoxyCodeLine{326 \}}
\DoxyCodeLine{327 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{328 }
\DoxyCodeLine{329 \textcolor{keyword}{static} FILE *stbiw\_\_fopen(\textcolor{keywordtype}{char} \textcolor{keyword}{const} *filename, \textcolor{keywordtype}{char} \textcolor{keyword}{const} *mode) \{}
\DoxyCodeLine{330   FILE *f;}
\DoxyCodeLine{331 \textcolor{preprocessor}{\#if defined(\_WIN32) \&\& defined(STBIW\_WINDOWS\_UTF8)}}
\DoxyCodeLine{332   \textcolor{keywordtype}{wchar\_t} wMode[64];}
\DoxyCodeLine{333   \textcolor{keywordtype}{wchar\_t} wFilename[1024];}
\DoxyCodeLine{334   \textcolor{keywordflow}{if} (0 == MultiByteToWideChar(65001 \textcolor{comment}{/* UTF8 */}, 0, filename, -\/1, wFilename,}
\DoxyCodeLine{335                                \textcolor{keyword}{sizeof}(wFilename) / \textcolor{keyword}{sizeof}(*wFilename)))}
\DoxyCodeLine{336     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{337 }
\DoxyCodeLine{338   \textcolor{keywordflow}{if} (0 == MultiByteToWideChar(65001 \textcolor{comment}{/* UTF8 */}, 0, mode, -\/1, wMode,}
\DoxyCodeLine{339                                \textcolor{keyword}{sizeof}(wMode) / \textcolor{keyword}{sizeof}(*wMode)))}
\DoxyCodeLine{340     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{341 }
\DoxyCodeLine{342 \textcolor{preprocessor}{\#if defined(\_MSC\_VER) \&\& \_MSC\_VER >= 1400}}
\DoxyCodeLine{343   \textcolor{keywordflow}{if} (0 != \_wfopen\_s(\&f, wFilename, wMode))}
\DoxyCodeLine{344     f = 0;}
\DoxyCodeLine{345 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{346   f = \_wfopen(wFilename, wMode);}
\DoxyCodeLine{347 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{348 }
\DoxyCodeLine{349 \textcolor{preprocessor}{\#elif defined(\_MSC\_VER) \&\& \_MSC\_VER >= 1400}}
\DoxyCodeLine{350   \textcolor{keywordflow}{if} (0 != fopen\_s(\&f, filename, mode))}
\DoxyCodeLine{351     f = 0;}
\DoxyCodeLine{352 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{353   f = fopen(filename, mode);}
\DoxyCodeLine{354 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{355   \textcolor{keywordflow}{return} f;}
\DoxyCodeLine{356 \}}
\DoxyCodeLine{357 }
\DoxyCodeLine{358 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_\_start\_write\_file(stbi\_\_write\_context *s,}
\DoxyCodeLine{359                                   \textcolor{keyword}{const} \textcolor{keywordtype}{char} *filename) \{}
\DoxyCodeLine{360   FILE *f = stbiw\_\_fopen(filename, \textcolor{stringliteral}{"{}wb"{}});}
\DoxyCodeLine{361   stbi\_\_start\_write\_callbacks(s, stbi\_\_stdio\_write, (\textcolor{keywordtype}{void} *)f);}
\DoxyCodeLine{362   \textcolor{keywordflow}{return} f != NULL;}
\DoxyCodeLine{363 \}}
\DoxyCodeLine{364 }
\DoxyCodeLine{365 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbi\_\_end\_write\_file(stbi\_\_write\_context *s) \{}
\DoxyCodeLine{366   fclose((FILE *)s-\/>context);}
\DoxyCodeLine{367 \}}
\DoxyCodeLine{368 }
\DoxyCodeLine{369 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// !STBI\_WRITE\_NO\_STDIO}}
\DoxyCodeLine{370 }
\DoxyCodeLine{371 \textcolor{keyword}{typedef} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} stbiw\_uint32;}
\DoxyCodeLine{372 \textcolor{keyword}{typedef} \textcolor{keywordtype}{int} stb\_image\_write\_test[\textcolor{keyword}{sizeof}(stbiw\_uint32) == 4 ? 1 : -\/1];}
\DoxyCodeLine{373 }
\DoxyCodeLine{374 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbiw\_\_writefv(stbi\_\_write\_context *s, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *fmt, va\_list v) \{}
\DoxyCodeLine{375   \textcolor{keywordflow}{while} (*fmt) \{}
\DoxyCodeLine{376     \textcolor{keywordflow}{switch} (*fmt++) \{}
\DoxyCodeLine{377     \textcolor{keywordflow}{case} \textcolor{charliteral}{' '}:}
\DoxyCodeLine{378       \textcolor{keywordflow}{break};}
\DoxyCodeLine{379     \textcolor{keywordflow}{case} \textcolor{charliteral}{'1'}: \{}
\DoxyCodeLine{380       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} x = STBIW\_UCHAR(va\_arg(v, \textcolor{keywordtype}{int}));}
\DoxyCodeLine{381       s-\/>func(s-\/>context, \&x, 1);}
\DoxyCodeLine{382       \textcolor{keywordflow}{break};}
\DoxyCodeLine{383     \}}
\DoxyCodeLine{384     \textcolor{keywordflow}{case} \textcolor{charliteral}{'2'}: \{}
\DoxyCodeLine{385       \textcolor{keywordtype}{int} x = va\_arg(v, \textcolor{keywordtype}{int});}
\DoxyCodeLine{386       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} b[2];}
\DoxyCodeLine{387       b[0] = STBIW\_UCHAR(x);}
\DoxyCodeLine{388       b[1] = STBIW\_UCHAR(x >> 8);}
\DoxyCodeLine{389       s-\/>func(s-\/>context, b, 2);}
\DoxyCodeLine{390       \textcolor{keywordflow}{break};}
\DoxyCodeLine{391     \}}
\DoxyCodeLine{392     \textcolor{keywordflow}{case} \textcolor{charliteral}{'4'}: \{}
\DoxyCodeLine{393       stbiw\_uint32 x = va\_arg(v, \textcolor{keywordtype}{int});}
\DoxyCodeLine{394       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} b[4];}
\DoxyCodeLine{395       b[0] = STBIW\_UCHAR(x);}
\DoxyCodeLine{396       b[1] = STBIW\_UCHAR(x >> 8);}
\DoxyCodeLine{397       b[2] = STBIW\_UCHAR(x >> 16);}
\DoxyCodeLine{398       b[3] = STBIW\_UCHAR(x >> 24);}
\DoxyCodeLine{399       s-\/>func(s-\/>context, b, 4);}
\DoxyCodeLine{400       \textcolor{keywordflow}{break};}
\DoxyCodeLine{401     \}}
\DoxyCodeLine{402     \textcolor{keywordflow}{default}:}
\DoxyCodeLine{403       STBIW\_ASSERT(0);}
\DoxyCodeLine{404       \textcolor{keywordflow}{return};}
\DoxyCodeLine{405     \}}
\DoxyCodeLine{406   \}}
\DoxyCodeLine{407 \}}
\DoxyCodeLine{408 }
\DoxyCodeLine{409 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbiw\_\_writef(stbi\_\_write\_context *s, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *fmt, ...) \{}
\DoxyCodeLine{410   va\_list v;}
\DoxyCodeLine{411   va\_start(v, fmt);}
\DoxyCodeLine{412   stbiw\_\_writefv(s, fmt, v);}
\DoxyCodeLine{413   va\_end(v);}
\DoxyCodeLine{414 \}}
\DoxyCodeLine{415 }
\DoxyCodeLine{416 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbiw\_\_write\_flush(stbi\_\_write\_context *s) \{}
\DoxyCodeLine{417   \textcolor{keywordflow}{if} (s-\/>buf\_used) \{}
\DoxyCodeLine{418     s-\/>func(s-\/>context, \&s-\/>buffer, s-\/>buf\_used);}
\DoxyCodeLine{419     s-\/>buf\_used = 0;}
\DoxyCodeLine{420   \}}
\DoxyCodeLine{421 \}}
\DoxyCodeLine{422 }
\DoxyCodeLine{423 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbiw\_\_putc(stbi\_\_write\_context *s, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} c) \{}
\DoxyCodeLine{424   s-\/>func(s-\/>context, \&c, 1);}
\DoxyCodeLine{425 \}}
\DoxyCodeLine{426 }
\DoxyCodeLine{427 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbiw\_\_write1(stbi\_\_write\_context *s, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} a) \{}
\DoxyCodeLine{428   \textcolor{keywordflow}{if} ((\textcolor{keywordtype}{size\_t})s-\/>buf\_used + 1 > \textcolor{keyword}{sizeof}(s-\/>buffer))}
\DoxyCodeLine{429     stbiw\_\_write\_flush(s);}
\DoxyCodeLine{430   s-\/>buffer[s-\/>buf\_used++] = a;}
\DoxyCodeLine{431 \}}
\DoxyCodeLine{432 }
\DoxyCodeLine{433 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbiw\_\_write3(stbi\_\_write\_context *s, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} a,}
\DoxyCodeLine{434                           \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} b, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} c) \{}
\DoxyCodeLine{435   \textcolor{keywordtype}{int} n;}
\DoxyCodeLine{436   \textcolor{keywordflow}{if} ((\textcolor{keywordtype}{size\_t})s-\/>buf\_used + 3 > \textcolor{keyword}{sizeof}(s-\/>buffer))}
\DoxyCodeLine{437     stbiw\_\_write\_flush(s);}
\DoxyCodeLine{438   n = s-\/>buf\_used;}
\DoxyCodeLine{439   s-\/>buf\_used = n + 3;}
\DoxyCodeLine{440   s-\/>buffer[n + 0] = a;}
\DoxyCodeLine{441   s-\/>buffer[n + 1] = b;}
\DoxyCodeLine{442   s-\/>buffer[n + 2] = c;}
\DoxyCodeLine{443 \}}
\DoxyCodeLine{444 }
\DoxyCodeLine{445 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbiw\_\_write\_pixel(stbi\_\_write\_context *s, \textcolor{keywordtype}{int} rgb\_dir, \textcolor{keywordtype}{int} comp,}
\DoxyCodeLine{446                                \textcolor{keywordtype}{int} write\_alpha, \textcolor{keywordtype}{int} expand\_mono,}
\DoxyCodeLine{447                                \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *d) \{}
\DoxyCodeLine{448   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} bg[3] = \{255, 0, 255\}, px[3];}
\DoxyCodeLine{449   \textcolor{keywordtype}{int} k;}
\DoxyCodeLine{450 }
\DoxyCodeLine{451   \textcolor{keywordflow}{if} (write\_alpha < 0)}
\DoxyCodeLine{452     stbiw\_\_write1(s, d[comp -\/ 1]);}
\DoxyCodeLine{453 }
\DoxyCodeLine{454   \textcolor{keywordflow}{switch} (comp) \{}
\DoxyCodeLine{455   \textcolor{keywordflow}{case} 2: \textcolor{comment}{// 2 pixels = mono + alpha, alpha is written separately, so same as}}
\DoxyCodeLine{456           \textcolor{comment}{// 1-\/channel case}}
\DoxyCodeLine{457   \textcolor{keywordflow}{case} 1:}
\DoxyCodeLine{458     \textcolor{keywordflow}{if} (expand\_mono)}
\DoxyCodeLine{459       stbiw\_\_write3(s, d[0], d[0], d[0]); \textcolor{comment}{// monochrome bmp}}
\DoxyCodeLine{460     \textcolor{keywordflow}{else}}
\DoxyCodeLine{461       stbiw\_\_write1(s, d[0]); \textcolor{comment}{// monochrome TGA}}
\DoxyCodeLine{462     \textcolor{keywordflow}{break};}
\DoxyCodeLine{463   \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{464     \textcolor{keywordflow}{if} (!write\_alpha) \{}
\DoxyCodeLine{465       \textcolor{comment}{// composite against pink background}}
\DoxyCodeLine{466       \textcolor{keywordflow}{for} (k = 0; k < 3; ++k)}
\DoxyCodeLine{467         px[k] = bg[k] + ((d[k] -\/ bg[k]) * d[3]) / 255;}
\DoxyCodeLine{468       stbiw\_\_write3(s, px[1 -\/ rgb\_dir], px[1], px[1 + rgb\_dir]);}
\DoxyCodeLine{469       \textcolor{keywordflow}{break};}
\DoxyCodeLine{470     \}}
\DoxyCodeLine{471     \textcolor{comment}{/* FALLTHROUGH */}}
\DoxyCodeLine{472   \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{473     stbiw\_\_write3(s, d[1 -\/ rgb\_dir], d[1], d[1 + rgb\_dir]);}
\DoxyCodeLine{474     \textcolor{keywordflow}{break};}
\DoxyCodeLine{475   \}}
\DoxyCodeLine{476   \textcolor{keywordflow}{if} (write\_alpha > 0)}
\DoxyCodeLine{477     stbiw\_\_write1(s, d[comp -\/ 1]);}
\DoxyCodeLine{478 \}}
\DoxyCodeLine{479 }
\DoxyCodeLine{480 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbiw\_\_write\_pixels(stbi\_\_write\_context *s, \textcolor{keywordtype}{int} rgb\_dir, \textcolor{keywordtype}{int} vdir,}
\DoxyCodeLine{481                                 \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp, \textcolor{keywordtype}{void} *data,}
\DoxyCodeLine{482                                 \textcolor{keywordtype}{int} write\_alpha, \textcolor{keywordtype}{int} scanline\_pad,}
\DoxyCodeLine{483                                 \textcolor{keywordtype}{int} expand\_mono) \{}
\DoxyCodeLine{484   stbiw\_uint32 zero = 0;}
\DoxyCodeLine{485   \textcolor{keywordtype}{int} i, j, j\_end;}
\DoxyCodeLine{486 }
\DoxyCodeLine{487   \textcolor{keywordflow}{if} (y <= 0)}
\DoxyCodeLine{488     \textcolor{keywordflow}{return};}
\DoxyCodeLine{489 }
\DoxyCodeLine{490   \textcolor{keywordflow}{if} (stbi\_\_flip\_vertically\_on\_write)}
\DoxyCodeLine{491     vdir *= -\/1;}
\DoxyCodeLine{492 }
\DoxyCodeLine{493   \textcolor{keywordflow}{if} (vdir < 0) \{}
\DoxyCodeLine{494     j\_end = -\/1;}
\DoxyCodeLine{495     j = y -\/ 1;}
\DoxyCodeLine{496   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{497     j\_end = y;}
\DoxyCodeLine{498     j = 0;}
\DoxyCodeLine{499   \}}
\DoxyCodeLine{500 }
\DoxyCodeLine{501   \textcolor{keywordflow}{for} (; j != j\_end; j += vdir) \{}
\DoxyCodeLine{502     \textcolor{keywordflow}{for} (i = 0; i < x; ++i) \{}
\DoxyCodeLine{503       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *d = (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *)data + (j * x + i) * comp;}
\DoxyCodeLine{504       stbiw\_\_write\_pixel(s, rgb\_dir, comp, write\_alpha, expand\_mono, d);}
\DoxyCodeLine{505     \}}
\DoxyCodeLine{506     stbiw\_\_write\_flush(s);}
\DoxyCodeLine{507     s-\/>func(s-\/>context, \&zero, scanline\_pad);}
\DoxyCodeLine{508   \}}
\DoxyCodeLine{509 \}}
\DoxyCodeLine{510 }
\DoxyCodeLine{511 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbiw\_\_outfile(stbi\_\_write\_context *s, \textcolor{keywordtype}{int} rgb\_dir, \textcolor{keywordtype}{int} vdir, \textcolor{keywordtype}{int} x,}
\DoxyCodeLine{512                           \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp, \textcolor{keywordtype}{int} expand\_mono, \textcolor{keywordtype}{void} *data,}
\DoxyCodeLine{513                           \textcolor{keywordtype}{int} alpha, \textcolor{keywordtype}{int} pad, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *fmt, ...) \{}
\DoxyCodeLine{514   \textcolor{keywordflow}{if} (y < 0 || x < 0) \{}
\DoxyCodeLine{515     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{516   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{517     va\_list v;}
\DoxyCodeLine{518     va\_start(v, fmt);}
\DoxyCodeLine{519     stbiw\_\_writefv(s, fmt, v);}
\DoxyCodeLine{520     va\_end(v);}
\DoxyCodeLine{521     stbiw\_\_write\_pixels(s, rgb\_dir, vdir, x, y, comp, data, alpha, pad,}
\DoxyCodeLine{522                         expand\_mono);}
\DoxyCodeLine{523     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{524   \}}
\DoxyCodeLine{525 \}}
\DoxyCodeLine{526 }
\DoxyCodeLine{527 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_write\_bmp\_core(stbi\_\_write\_context *s, \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp,}
\DoxyCodeLine{528                                \textcolor{keyword}{const} \textcolor{keywordtype}{void} *data) \{}
\DoxyCodeLine{529   \textcolor{keywordflow}{if} (comp != 4) \{}
\DoxyCodeLine{530     \textcolor{comment}{// write RGB bitmap}}
\DoxyCodeLine{531     \textcolor{keywordtype}{int} pad = (-\/x * 3) \& 3;}
\DoxyCodeLine{532     \textcolor{keywordflow}{return} stbiw\_\_outfile(s, -\/1, -\/1, x, y, comp, 1, (\textcolor{keywordtype}{void} *)data, 0, pad,}
\DoxyCodeLine{533                           \textcolor{stringliteral}{"{}11 4 22 4"{}}}
\DoxyCodeLine{534                           \textcolor{stringliteral}{"{}4 44 22 444444"{}},}
\DoxyCodeLine{535                           \textcolor{charliteral}{'B'}, \textcolor{charliteral}{'M'}, 14 + 40 + (x * 3 + pad) * y, 0, 0,}
\DoxyCodeLine{536                           14 + 40,                            \textcolor{comment}{// file header}}
\DoxyCodeLine{537                           40, x, y, 1, 24, 0, 0, 0, 0, 0, 0); \textcolor{comment}{// bitmap header}}
\DoxyCodeLine{538   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{539     \textcolor{comment}{// RGBA bitmaps need a v4 header}}
\DoxyCodeLine{540     \textcolor{comment}{// use BI\_BITFIELDS mode with 32bpp and alpha mask}}
\DoxyCodeLine{541     \textcolor{comment}{// (straight BI\_RGB with alpha mask doesn't work in most readers)}}
\DoxyCodeLine{542     \textcolor{keywordflow}{return} stbiw\_\_outfile(}
\DoxyCodeLine{543         s, -\/1, -\/1, x, y, comp, 1, (\textcolor{keywordtype}{void} *)data, 1, 0,}
\DoxyCodeLine{544         \textcolor{stringliteral}{"{}11 4 22 4"{}}}
\DoxyCodeLine{545         \textcolor{stringliteral}{"{}4 44 22 444444 4444 4 444 444 444 444"{}},}
\DoxyCodeLine{546         \textcolor{charliteral}{'B'}, \textcolor{charliteral}{'M'}, 14 + 108 + x * y * 4, 0, 0, 14 + 108, \textcolor{comment}{// file header}}
\DoxyCodeLine{547         108, x, y, 1, 32, 3, 0, 0, 0, 0, 0, 0xff0000, 0xff00, 0xff, 0xff000000u,}
\DoxyCodeLine{548         0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0); \textcolor{comment}{// bitmap V4 header}}
\DoxyCodeLine{549   \}}
\DoxyCodeLine{550 \}}
\DoxyCodeLine{551 }
\DoxyCodeLine{552 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_bmp\_to\_func(stbi\_write\_func *func, \textcolor{keywordtype}{void} *context, \textcolor{keywordtype}{int} x,}
\DoxyCodeLine{553                                     \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp, \textcolor{keyword}{const} \textcolor{keywordtype}{void} *data) \{}
\DoxyCodeLine{554   stbi\_\_write\_context s = \{0\};}
\DoxyCodeLine{555   stbi\_\_start\_write\_callbacks(\&s, func, context);}
\DoxyCodeLine{556   \textcolor{keywordflow}{return} stbi\_write\_bmp\_core(\&s, x, y, comp, data);}
\DoxyCodeLine{557 \}}
\DoxyCodeLine{558 }
\DoxyCodeLine{559 \textcolor{preprocessor}{\#ifndef STBI\_WRITE\_NO\_STDIO}}
\DoxyCodeLine{560 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_bmp(\textcolor{keywordtype}{char} \textcolor{keyword}{const} *filename, \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp,}
\DoxyCodeLine{561                             \textcolor{keyword}{const} \textcolor{keywordtype}{void} *data) \{}
\DoxyCodeLine{562   stbi\_\_write\_context s = \{0\};}
\DoxyCodeLine{563   \textcolor{keywordflow}{if} (stbi\_\_start\_write\_file(\&s, filename)) \{}
\DoxyCodeLine{564     \textcolor{keywordtype}{int} r = stbi\_write\_bmp\_core(\&s, x, y, comp, data);}
\DoxyCodeLine{565     stbi\_\_end\_write\_file(\&s);}
\DoxyCodeLine{566     \textcolor{keywordflow}{return} r;}
\DoxyCodeLine{567   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{568     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{569 \}}
\DoxyCodeLine{570 \textcolor{preprocessor}{\#endif }}
\DoxyCodeLine{571 }
\DoxyCodeLine{572 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_write\_tga\_core(stbi\_\_write\_context *s, \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp,}
\DoxyCodeLine{573                                \textcolor{keywordtype}{void} *data) \{}
\DoxyCodeLine{574   \textcolor{keywordtype}{int} has\_alpha = (comp == 2 || comp == 4);}
\DoxyCodeLine{575   \textcolor{keywordtype}{int} colorbytes = has\_alpha ? comp -\/ 1 : comp;}
\DoxyCodeLine{576   \textcolor{keywordtype}{int} format =}
\DoxyCodeLine{577       colorbytes < 2}
\DoxyCodeLine{578           ? 3}
\DoxyCodeLine{579           : 2; \textcolor{comment}{// 3 color channels (RGB/RGBA) = 2, 1 color channel (Y/YA) = 3}}
\DoxyCodeLine{580 }
\DoxyCodeLine{581   \textcolor{keywordflow}{if} (y < 0 || x < 0)}
\DoxyCodeLine{582     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{583 }
\DoxyCodeLine{584   \textcolor{keywordflow}{if} (!stbi\_write\_tga\_with\_rle) \{}
\DoxyCodeLine{585     \textcolor{keywordflow}{return} stbiw\_\_outfile(s, -\/1, -\/1, x, y, comp, 0, (\textcolor{keywordtype}{void} *)data, has\_alpha, 0,}
\DoxyCodeLine{586                           \textcolor{stringliteral}{"{}111 221 2222 11"{}}, 0, 0, format, 0, 0, 0, 0, 0, x, y,}
\DoxyCodeLine{587                           (colorbytes + has\_alpha) * 8, has\_alpha * 8);}
\DoxyCodeLine{588   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{589     \textcolor{keywordtype}{int} i, j, k;}
\DoxyCodeLine{590     \textcolor{keywordtype}{int} jend, jdir;}
\DoxyCodeLine{591 }
\DoxyCodeLine{592     stbiw\_\_writef(s, \textcolor{stringliteral}{"{}111 221 2222 11"{}}, 0, 0, format + 8, 0, 0, 0, 0, 0, x, y,}
\DoxyCodeLine{593                   (colorbytes + has\_alpha) * 8, has\_alpha * 8);}
\DoxyCodeLine{594 }
\DoxyCodeLine{595     \textcolor{keywordflow}{if} (stbi\_\_flip\_vertically\_on\_write) \{}
\DoxyCodeLine{596       j = 0;}
\DoxyCodeLine{597       jend = y;}
\DoxyCodeLine{598       jdir = 1;}
\DoxyCodeLine{599     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{600       j = y -\/ 1;}
\DoxyCodeLine{601       jend = -\/1;}
\DoxyCodeLine{602       jdir = -\/1;}
\DoxyCodeLine{603     \}}
\DoxyCodeLine{604     \textcolor{keywordflow}{for} (; j != jend; j += jdir) \{}
\DoxyCodeLine{605       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *row = (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *)data + j * x * comp;}
\DoxyCodeLine{606       \textcolor{keywordtype}{int} len;}
\DoxyCodeLine{607 }
\DoxyCodeLine{608       \textcolor{keywordflow}{for} (i = 0; i < x; i += len) \{}
\DoxyCodeLine{609         \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *begin = row + i * comp;}
\DoxyCodeLine{610         \textcolor{keywordtype}{int} diff = 1;}
\DoxyCodeLine{611         len = 1;}
\DoxyCodeLine{612 }
\DoxyCodeLine{613         \textcolor{keywordflow}{if} (i < x -\/ 1) \{}
\DoxyCodeLine{614           ++len;}
\DoxyCodeLine{615           diff = memcmp(begin, row + (i + 1) * comp, comp);}
\DoxyCodeLine{616           \textcolor{keywordflow}{if} (diff) \{}
\DoxyCodeLine{617             \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *prev = begin;}
\DoxyCodeLine{618             \textcolor{keywordflow}{for} (k = i + 2; k < x \&\& len < 128; ++k) \{}
\DoxyCodeLine{619               \textcolor{keywordflow}{if} (memcmp(prev, row + k * comp, comp)) \{}
\DoxyCodeLine{620                 prev += comp;}
\DoxyCodeLine{621                 ++len;}
\DoxyCodeLine{622               \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{623                 -\/-\/len;}
\DoxyCodeLine{624                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{625               \}}
\DoxyCodeLine{626             \}}
\DoxyCodeLine{627           \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{628             \textcolor{keywordflow}{for} (k = i + 2; k < x \&\& len < 128; ++k) \{}
\DoxyCodeLine{629               \textcolor{keywordflow}{if} (!memcmp(begin, row + k * comp, comp)) \{}
\DoxyCodeLine{630                 ++len;}
\DoxyCodeLine{631               \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{632                 \textcolor{keywordflow}{break};}
\DoxyCodeLine{633               \}}
\DoxyCodeLine{634             \}}
\DoxyCodeLine{635           \}}
\DoxyCodeLine{636         \}}
\DoxyCodeLine{637 }
\DoxyCodeLine{638         \textcolor{keywordflow}{if} (diff) \{}
\DoxyCodeLine{639           \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} header = STBIW\_UCHAR(len -\/ 1);}
\DoxyCodeLine{640           stbiw\_\_write1(s, header);}
\DoxyCodeLine{641           \textcolor{keywordflow}{for} (k = 0; k < len; ++k) \{}
\DoxyCodeLine{642             stbiw\_\_write\_pixel(s, -\/1, comp, has\_alpha, 0, begin + k * comp);}
\DoxyCodeLine{643           \}}
\DoxyCodeLine{644         \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{645           \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} header = STBIW\_UCHAR(len -\/ 129);}
\DoxyCodeLine{646           stbiw\_\_write1(s, header);}
\DoxyCodeLine{647           stbiw\_\_write\_pixel(s, -\/1, comp, has\_alpha, 0, begin);}
\DoxyCodeLine{648         \}}
\DoxyCodeLine{649       \}}
\DoxyCodeLine{650     \}}
\DoxyCodeLine{651     stbiw\_\_write\_flush(s);}
\DoxyCodeLine{652   \}}
\DoxyCodeLine{653   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{654 \}}
\DoxyCodeLine{655 }
\DoxyCodeLine{656 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_tga\_to\_func(stbi\_write\_func *func, \textcolor{keywordtype}{void} *context, \textcolor{keywordtype}{int} x,}
\DoxyCodeLine{657                                     \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp, \textcolor{keyword}{const} \textcolor{keywordtype}{void} *data) \{}
\DoxyCodeLine{658   stbi\_\_write\_context s = \{0\};}
\DoxyCodeLine{659   stbi\_\_start\_write\_callbacks(\&s, func, context);}
\DoxyCodeLine{660   \textcolor{keywordflow}{return} stbi\_write\_tga\_core(\&s, x, y, comp, (\textcolor{keywordtype}{void} *)data);}
\DoxyCodeLine{661 \}}
\DoxyCodeLine{662 }
\DoxyCodeLine{663 \textcolor{preprocessor}{\#ifndef STBI\_WRITE\_NO\_STDIO}}
\DoxyCodeLine{664 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_tga(\textcolor{keywordtype}{char} \textcolor{keyword}{const} *filename, \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp,}
\DoxyCodeLine{665                             \textcolor{keyword}{const} \textcolor{keywordtype}{void} *data) \{}
\DoxyCodeLine{666   stbi\_\_write\_context s = \{0\};}
\DoxyCodeLine{667   \textcolor{keywordflow}{if} (stbi\_\_start\_write\_file(\&s, filename)) \{}
\DoxyCodeLine{668     \textcolor{keywordtype}{int} r = stbi\_write\_tga\_core(\&s, x, y, comp, (\textcolor{keywordtype}{void} *)data);}
\DoxyCodeLine{669     stbi\_\_end\_write\_file(\&s);}
\DoxyCodeLine{670     \textcolor{keywordflow}{return} r;}
\DoxyCodeLine{671   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{672     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{673 \}}
\DoxyCodeLine{674 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{675 }
\DoxyCodeLine{676 \textcolor{comment}{// *************************************************************************************************}}
\DoxyCodeLine{677 \textcolor{comment}{// Radiance RGBE HDR writer}}
\DoxyCodeLine{678 \textcolor{comment}{// by Baldur Karlsson}}
\DoxyCodeLine{679 }
\DoxyCodeLine{680 \textcolor{preprocessor}{\#define stbiw\_\_max(a, b) ((a) > (b) ? (a) : (b))}}
\DoxyCodeLine{681 }
\DoxyCodeLine{682 \textcolor{preprocessor}{\#ifndef STBI\_WRITE\_NO\_STDIO}}
\DoxyCodeLine{683 }
\DoxyCodeLine{684 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbiw\_\_linear\_to\_rgbe(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *rgbe, \textcolor{keywordtype}{float} *linear) \{}
\DoxyCodeLine{685   \textcolor{keywordtype}{int} exponent;}
\DoxyCodeLine{686   \textcolor{keywordtype}{float} maxcomp = stbiw\_\_max(linear[0], stbiw\_\_max(linear[1], linear[2]));}
\DoxyCodeLine{687 }
\DoxyCodeLine{688   \textcolor{keywordflow}{if} (maxcomp < 1e-\/32f) \{}
\DoxyCodeLine{689     rgbe[0] = rgbe[1] = rgbe[2] = rgbe[3] = 0;}
\DoxyCodeLine{690   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{691     \textcolor{keywordtype}{float} normalize = (float)frexp(maxcomp, \&exponent) * 256.0f / maxcomp;}
\DoxyCodeLine{692 }
\DoxyCodeLine{693     rgbe[0] = (\textcolor{keywordtype}{unsigned} char)(linear[0] * normalize);}
\DoxyCodeLine{694     rgbe[1] = (\textcolor{keywordtype}{unsigned} char)(linear[1] * normalize);}
\DoxyCodeLine{695     rgbe[2] = (\textcolor{keywordtype}{unsigned} char)(linear[2] * normalize);}
\DoxyCodeLine{696     rgbe[3] = (\textcolor{keywordtype}{unsigned} char)(exponent + 128);}
\DoxyCodeLine{697   \}}
\DoxyCodeLine{698 \}}
\DoxyCodeLine{699 }
\DoxyCodeLine{700 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbiw\_\_write\_run\_data(stbi\_\_write\_context *s, \textcolor{keywordtype}{int} length,}
\DoxyCodeLine{701                                   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} databyte) \{}
\DoxyCodeLine{702   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} lengthbyte = STBIW\_UCHAR(length + 128);}
\DoxyCodeLine{703   STBIW\_ASSERT(length + 128 <= 255);}
\DoxyCodeLine{704   s-\/>func(s-\/>context, \&lengthbyte, 1);}
\DoxyCodeLine{705   s-\/>func(s-\/>context, \&databyte, 1);}
\DoxyCodeLine{706 \}}
\DoxyCodeLine{707 }
\DoxyCodeLine{708 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbiw\_\_write\_dump\_data(stbi\_\_write\_context *s, \textcolor{keywordtype}{int} length,}
\DoxyCodeLine{709                                    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *data) \{}
\DoxyCodeLine{710   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} lengthbyte = STBIW\_UCHAR(length);}
\DoxyCodeLine{711   STBIW\_ASSERT(length <=}
\DoxyCodeLine{712                128); \textcolor{comment}{// inconsistent with spec but consistent with official code}}
\DoxyCodeLine{713   s-\/>func(s-\/>context, \&lengthbyte, 1);}
\DoxyCodeLine{714   s-\/>func(s-\/>context, data, length);}
\DoxyCodeLine{715 \}}
\DoxyCodeLine{716 }
\DoxyCodeLine{717 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbiw\_\_write\_hdr\_scanline(stbi\_\_write\_context *s, \textcolor{keywordtype}{int} width,}
\DoxyCodeLine{718                                       \textcolor{keywordtype}{int} ncomp, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *scratch,}
\DoxyCodeLine{719                                       \textcolor{keywordtype}{float} *scanline) \{}
\DoxyCodeLine{720   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} scanlineheader[4] = \{2, 2, 0, 0\};}
\DoxyCodeLine{721   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} rgbe[4];}
\DoxyCodeLine{722   \textcolor{keywordtype}{float} linear[3];}
\DoxyCodeLine{723   \textcolor{keywordtype}{int} x;}
\DoxyCodeLine{724 }
\DoxyCodeLine{725   scanlineheader[2] = (width \& 0xff00) >> 8;}
\DoxyCodeLine{726   scanlineheader[3] = (width \& 0x00ff);}
\DoxyCodeLine{727 }
\DoxyCodeLine{728   \textcolor{comment}{/* skip RLE for images too small or large */}}
\DoxyCodeLine{729   \textcolor{keywordflow}{if} (width < 8 || width >= 32768) \{}
\DoxyCodeLine{730     \textcolor{keywordflow}{for} (x = 0; x < width; x++) \{}
\DoxyCodeLine{731       \textcolor{keywordflow}{switch} (ncomp) \{}
\DoxyCodeLine{732       \textcolor{keywordflow}{case} 4: \textcolor{comment}{/* fallthrough */}}
\DoxyCodeLine{733       \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{734         linear[2] = scanline[x * ncomp + 2];}
\DoxyCodeLine{735         linear[1] = scanline[x * ncomp + 1];}
\DoxyCodeLine{736         linear[0] = scanline[x * ncomp + 0];}
\DoxyCodeLine{737         \textcolor{keywordflow}{break};}
\DoxyCodeLine{738       \textcolor{keywordflow}{default}:}
\DoxyCodeLine{739         linear[0] = linear[1] = linear[2] = scanline[x * ncomp + 0];}
\DoxyCodeLine{740         \textcolor{keywordflow}{break};}
\DoxyCodeLine{741       \}}
\DoxyCodeLine{742       stbiw\_\_linear\_to\_rgbe(rgbe, linear);}
\DoxyCodeLine{743       s-\/>func(s-\/>context, rgbe, 4);}
\DoxyCodeLine{744     \}}
\DoxyCodeLine{745   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{746     \textcolor{keywordtype}{int} c, r;}
\DoxyCodeLine{747     \textcolor{comment}{/* encode into scratch buffer */}}
\DoxyCodeLine{748     \textcolor{keywordflow}{for} (x = 0; x < width; x++) \{}
\DoxyCodeLine{749       \textcolor{keywordflow}{switch} (ncomp) \{}
\DoxyCodeLine{750       \textcolor{keywordflow}{case} 4: \textcolor{comment}{/* fallthrough */}}
\DoxyCodeLine{751       \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{752         linear[2] = scanline[x * ncomp + 2];}
\DoxyCodeLine{753         linear[1] = scanline[x * ncomp + 1];}
\DoxyCodeLine{754         linear[0] = scanline[x * ncomp + 0];}
\DoxyCodeLine{755         \textcolor{keywordflow}{break};}
\DoxyCodeLine{756       \textcolor{keywordflow}{default}:}
\DoxyCodeLine{757         linear[0] = linear[1] = linear[2] = scanline[x * ncomp + 0];}
\DoxyCodeLine{758         \textcolor{keywordflow}{break};}
\DoxyCodeLine{759       \}}
\DoxyCodeLine{760       stbiw\_\_linear\_to\_rgbe(rgbe, linear);}
\DoxyCodeLine{761       scratch[x + width * 0] = rgbe[0];}
\DoxyCodeLine{762       scratch[x + width * 1] = rgbe[1];}
\DoxyCodeLine{763       scratch[x + width * 2] = rgbe[2];}
\DoxyCodeLine{764       scratch[x + width * 3] = rgbe[3];}
\DoxyCodeLine{765     \}}
\DoxyCodeLine{766 }
\DoxyCodeLine{767     s-\/>func(s-\/>context, scanlineheader, 4);}
\DoxyCodeLine{768 }
\DoxyCodeLine{769     \textcolor{comment}{/* RLE each component separately */}}
\DoxyCodeLine{770     \textcolor{keywordflow}{for} (c = 0; c < 4; c++) \{}
\DoxyCodeLine{771       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *comp = \&scratch[width * c];}
\DoxyCodeLine{772 }
\DoxyCodeLine{773       x = 0;}
\DoxyCodeLine{774       \textcolor{keywordflow}{while} (x < width) \{}
\DoxyCodeLine{775         \textcolor{comment}{// find first run}}
\DoxyCodeLine{776         r = x;}
\DoxyCodeLine{777         \textcolor{keywordflow}{while} (r + 2 < width) \{}
\DoxyCodeLine{778           \textcolor{keywordflow}{if} (comp[r] == comp[r + 1] \&\& comp[r] == comp[r + 2])}
\DoxyCodeLine{779             \textcolor{keywordflow}{break};}
\DoxyCodeLine{780           ++r;}
\DoxyCodeLine{781         \}}
\DoxyCodeLine{782         \textcolor{keywordflow}{if} (r + 2 >= width)}
\DoxyCodeLine{783           r = width;}
\DoxyCodeLine{784         \textcolor{comment}{// dump up to first run}}
\DoxyCodeLine{785         \textcolor{keywordflow}{while} (x < r) \{}
\DoxyCodeLine{786           \textcolor{keywordtype}{int} len = r -\/ x;}
\DoxyCodeLine{787           \textcolor{keywordflow}{if} (len > 128)}
\DoxyCodeLine{788             len = 128;}
\DoxyCodeLine{789           stbiw\_\_write\_dump\_data(s, len, \&comp[x]);}
\DoxyCodeLine{790           x += len;}
\DoxyCodeLine{791         \}}
\DoxyCodeLine{792         \textcolor{comment}{// if there's a run, output it}}
\DoxyCodeLine{793         \textcolor{keywordflow}{if} (r + 2 < width) \{ \textcolor{comment}{// same test as what we break out of in search}}
\DoxyCodeLine{794                              \textcolor{comment}{// loop, so only true if we break'd}}
\DoxyCodeLine{795           \textcolor{comment}{// find next byte after run}}
\DoxyCodeLine{796           \textcolor{keywordflow}{while} (r < width \&\& comp[r] == comp[x])}
\DoxyCodeLine{797             ++r;}
\DoxyCodeLine{798           \textcolor{comment}{// output run up to r}}
\DoxyCodeLine{799           \textcolor{keywordflow}{while} (x < r) \{}
\DoxyCodeLine{800             \textcolor{keywordtype}{int} len = r -\/ x;}
\DoxyCodeLine{801             \textcolor{keywordflow}{if} (len > 127)}
\DoxyCodeLine{802               len = 127;}
\DoxyCodeLine{803             stbiw\_\_write\_run\_data(s, len, comp[x]);}
\DoxyCodeLine{804             x += len;}
\DoxyCodeLine{805           \}}
\DoxyCodeLine{806         \}}
\DoxyCodeLine{807       \}}
\DoxyCodeLine{808     \}}
\DoxyCodeLine{809   \}}
\DoxyCodeLine{810 \}}
\DoxyCodeLine{811 }
\DoxyCodeLine{812 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_write\_hdr\_core(stbi\_\_write\_context *s, \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp,}
\DoxyCodeLine{813                                \textcolor{keywordtype}{float} *data) \{}
\DoxyCodeLine{814   \textcolor{keywordflow}{if} (y <= 0 || x <= 0 || data == NULL)}
\DoxyCodeLine{815     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{816   \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{817     \textcolor{comment}{// Each component is stored separately. Allocate scratch space for full}}
\DoxyCodeLine{818     \textcolor{comment}{// output scanline.}}
\DoxyCodeLine{819     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *scratch = (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *)STBIW\_MALLOC(x * 4);}
\DoxyCodeLine{820     \textcolor{keywordtype}{int} i, len;}
\DoxyCodeLine{821     \textcolor{keywordtype}{char} buffer[128];}
\DoxyCodeLine{822     \textcolor{keywordtype}{char} header[] =}
\DoxyCodeLine{823         \textcolor{stringliteral}{"{}\#?RADIANCE\(\backslash\)n\# Written by stb\_image\_write.h\(\backslash\)nFORMAT=32-\/bit\_rle\_rgbe\(\backslash\)n"{}};}
\DoxyCodeLine{824     s-\/>func(s-\/>context, header, \textcolor{keyword}{sizeof}(header) -\/ 1);}
\DoxyCodeLine{825 }
\DoxyCodeLine{826 \textcolor{preprocessor}{\#ifdef \_\_STDC\_LIB\_EXT1\_\_}}
\DoxyCodeLine{827     len =}
\DoxyCodeLine{828         sprintf\_s(buffer, \textcolor{keyword}{sizeof}(buffer),}
\DoxyCodeLine{829                   \textcolor{stringliteral}{"{}EXPOSURE=          1.0000000000000\(\backslash\)n\(\backslash\)n-\/Y \%d +X \%d\(\backslash\)n"{}}, y, x);}
\DoxyCodeLine{830 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{831     len = sprintf(buffer, \textcolor{stringliteral}{"{}EXPOSURE=          1.0000000000000\(\backslash\)n\(\backslash\)n-\/Y \%d +X \%d\(\backslash\)n"{}},}
\DoxyCodeLine{832                   y, x);}
\DoxyCodeLine{833 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{834     s-\/>func(s-\/>context, buffer, len);}
\DoxyCodeLine{835 }
\DoxyCodeLine{836     \textcolor{keywordflow}{for} (i = 0; i < y; i++)}
\DoxyCodeLine{837       stbiw\_\_write\_hdr\_scanline(}
\DoxyCodeLine{838           s, x, comp, scratch,}
\DoxyCodeLine{839           data + comp * x * (stbi\_\_flip\_vertically\_on\_write ? y -\/ 1 -\/ i : i));}
\DoxyCodeLine{840     STBIW\_FREE(scratch);}
\DoxyCodeLine{841     \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{842   \}}
\DoxyCodeLine{843 \}}
\DoxyCodeLine{844 }
\DoxyCodeLine{845 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_hdr\_to\_func(stbi\_write\_func *func, \textcolor{keywordtype}{void} *context, \textcolor{keywordtype}{int} x,}
\DoxyCodeLine{846                                     \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp, \textcolor{keyword}{const} \textcolor{keywordtype}{float} *data) \{}
\DoxyCodeLine{847   stbi\_\_write\_context s = \{0\};}
\DoxyCodeLine{848   stbi\_\_start\_write\_callbacks(\&s, func, context);}
\DoxyCodeLine{849   \textcolor{keywordflow}{return} stbi\_write\_hdr\_core(\&s, x, y, comp, (\textcolor{keywordtype}{float} *)data);}
\DoxyCodeLine{850 \}}
\DoxyCodeLine{851 }
\DoxyCodeLine{852 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_hdr(\textcolor{keywordtype}{char} \textcolor{keyword}{const} *filename, \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp,}
\DoxyCodeLine{853                             \textcolor{keyword}{const} \textcolor{keywordtype}{float} *data) \{}
\DoxyCodeLine{854   stbi\_\_write\_context s = \{0\};}
\DoxyCodeLine{855   \textcolor{keywordflow}{if} (stbi\_\_start\_write\_file(\&s, filename)) \{}
\DoxyCodeLine{856     \textcolor{keywordtype}{int} r = stbi\_write\_hdr\_core(\&s, x, y, comp, (\textcolor{keywordtype}{float} *)data);}
\DoxyCodeLine{857     stbi\_\_end\_write\_file(\&s);}
\DoxyCodeLine{858     \textcolor{keywordflow}{return} r;}
\DoxyCodeLine{859   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{860     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{861 \}}
\DoxyCodeLine{862 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// STBI\_WRITE\_NO\_STDIO}}
\DoxyCodeLine{863 }
\DoxyCodeLine{865 \textcolor{comment}{//}}
\DoxyCodeLine{866 \textcolor{comment}{// PNG writer}}
\DoxyCodeLine{867 \textcolor{comment}{//}}
\DoxyCodeLine{868 }
\DoxyCodeLine{869 \textcolor{preprocessor}{\#ifndef STBIW\_ZLIB\_COMPRESS}}
\DoxyCodeLine{870 \textcolor{comment}{// stretchy buffer; stbiw\_\_sbpush() == vector<>::push\_back() -\/-\/ stbiw\_\_sbcount()}}
\DoxyCodeLine{871 \textcolor{comment}{// == vector<>::size()}}
\DoxyCodeLine{872 \textcolor{preprocessor}{\#define stbiw\_\_sbraw(a) ((int *)(void *)(a)-\/2)}}
\DoxyCodeLine{873 \textcolor{preprocessor}{\#define stbiw\_\_sbm(a) stbiw\_\_sbraw(a)[0]}}
\DoxyCodeLine{874 \textcolor{preprocessor}{\#define stbiw\_\_sbn(a) stbiw\_\_sbraw(a)[1]}}
\DoxyCodeLine{875 }
\DoxyCodeLine{876 \textcolor{preprocessor}{\#define stbiw\_\_sbneedgrow(a, n) ((a) == 0 || stbiw\_\_sbn(a) + n >= stbiw\_\_sbm(a))}}
\DoxyCodeLine{877 \textcolor{preprocessor}{\#define stbiw\_\_sbmaybegrow(a, n)                                               \(\backslash\)}}
\DoxyCodeLine{878 \textcolor{preprocessor}{  (stbiw\_\_sbneedgrow(a, (n)) ? stbiw\_\_sbgrow(a, n) : 0)}}
\DoxyCodeLine{879 \textcolor{preprocessor}{\#define stbiw\_\_sbgrow(a, n) stbiw\_\_sbgrowf((void **)\&(a), (n), sizeof(*(a)))}}
\DoxyCodeLine{880 }
\DoxyCodeLine{881 \textcolor{preprocessor}{\#define stbiw\_\_sbpush(a, v)                                                    \(\backslash\)}}
\DoxyCodeLine{882 \textcolor{preprocessor}{  (stbiw\_\_sbmaybegrow(a, 1), (a)[stbiw\_\_sbn(a)++] = (v))}}
\DoxyCodeLine{883 \textcolor{preprocessor}{\#define stbiw\_\_sbcount(a) ((a) ? stbiw\_\_sbn(a) : 0)}}
\DoxyCodeLine{884 \textcolor{preprocessor}{\#define stbiw\_\_sbfree(a) ((a) ? STBIW\_FREE(stbiw\_\_sbraw(a)), 0 : 0)}}
\DoxyCodeLine{885 }
\DoxyCodeLine{886 \textcolor{keyword}{static} \textcolor{keywordtype}{void} *stbiw\_\_sbgrowf(\textcolor{keywordtype}{void} **arr, \textcolor{keywordtype}{int} increment, \textcolor{keywordtype}{int} itemsize) \{}
\DoxyCodeLine{887   \textcolor{keywordtype}{int} m = *arr ? 2 * stbiw\_\_sbm(*arr) + increment : increment + 1;}
\DoxyCodeLine{888   \textcolor{keywordtype}{void} *p = STBIW\_REALLOC\_SIZED(}
\DoxyCodeLine{889       *arr ? stbiw\_\_sbraw(*arr) : 0,}
\DoxyCodeLine{890       *arr ? (stbiw\_\_sbm(*arr) * itemsize + \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}) * 2) : 0,}
\DoxyCodeLine{891       itemsize * m + \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}) * 2);}
\DoxyCodeLine{892   STBIW\_ASSERT(p);}
\DoxyCodeLine{893   \textcolor{keywordflow}{if} (p) \{}
\DoxyCodeLine{894     \textcolor{keywordflow}{if} (!*arr)}
\DoxyCodeLine{895       ((\textcolor{keywordtype}{int} *)p)[1] = 0;}
\DoxyCodeLine{896     *arr = (\textcolor{keywordtype}{void} *)((\textcolor{keywordtype}{int} *)p + 2);}
\DoxyCodeLine{897     stbiw\_\_sbm(*arr) = m;}
\DoxyCodeLine{898   \}}
\DoxyCodeLine{899   \textcolor{keywordflow}{return} *arr;}
\DoxyCodeLine{900 \}}
\DoxyCodeLine{901 }
\DoxyCodeLine{902 \textcolor{keyword}{static} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *stbiw\_\_zlib\_flushf(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *data,}
\DoxyCodeLine{903                                          \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} *bitbuffer,}
\DoxyCodeLine{904                                          \textcolor{keywordtype}{int} *bitcount) \{}
\DoxyCodeLine{905   \textcolor{keywordflow}{while} (*bitcount >= 8) \{}
\DoxyCodeLine{906     stbiw\_\_sbpush(data, STBIW\_UCHAR(*bitbuffer));}
\DoxyCodeLine{907     *bitbuffer >>= 8;}
\DoxyCodeLine{908     *bitcount -\/= 8;}
\DoxyCodeLine{909   \}}
\DoxyCodeLine{910   \textcolor{keywordflow}{return} data;}
\DoxyCodeLine{911 \}}
\DoxyCodeLine{912 }
\DoxyCodeLine{913 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbiw\_\_zlib\_bitrev(\textcolor{keywordtype}{int} code, \textcolor{keywordtype}{int} codebits) \{}
\DoxyCodeLine{914   \textcolor{keywordtype}{int} res = 0;}
\DoxyCodeLine{915   \textcolor{keywordflow}{while} (codebits-\/-\/) \{}
\DoxyCodeLine{916     res = (res << 1) | (code \& 1);}
\DoxyCodeLine{917     code >>= 1;}
\DoxyCodeLine{918   \}}
\DoxyCodeLine{919   \textcolor{keywordflow}{return} res;}
\DoxyCodeLine{920 \}}
\DoxyCodeLine{921 }
\DoxyCodeLine{922 \textcolor{keyword}{static} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} stbiw\_\_zlib\_countm(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *a, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *b,}
\DoxyCodeLine{923                                        \textcolor{keywordtype}{int} limit) \{}
\DoxyCodeLine{924   \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{925   \textcolor{keywordflow}{for} (i = 0; i < limit \&\& i < 258; ++i)}
\DoxyCodeLine{926     \textcolor{keywordflow}{if} (a[i] != b[i])}
\DoxyCodeLine{927       \textcolor{keywordflow}{break};}
\DoxyCodeLine{928   \textcolor{keywordflow}{return} i;}
\DoxyCodeLine{929 \}}
\DoxyCodeLine{930 }
\DoxyCodeLine{931 \textcolor{keyword}{static} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} stbiw\_\_zhash(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *data) \{}
\DoxyCodeLine{932   stbiw\_uint32 hash = data[0] + (data[1] << 8) + (data[2] << 16);}
\DoxyCodeLine{933   hash \string^= hash << 3;}
\DoxyCodeLine{934   hash += hash >> 5;}
\DoxyCodeLine{935   hash \string^= hash << 4;}
\DoxyCodeLine{936   hash += hash >> 17;}
\DoxyCodeLine{937   hash \string^= hash << 25;}
\DoxyCodeLine{938   hash += hash >> 6;}
\DoxyCodeLine{939   \textcolor{keywordflow}{return} hash;}
\DoxyCodeLine{940 \}}
\DoxyCodeLine{941 }
\DoxyCodeLine{942 \textcolor{preprocessor}{\#define stbiw\_\_zlib\_flush() (out = stbiw\_\_zlib\_flushf(out, \&bitbuf, \&bitcount))}}
\DoxyCodeLine{943 \textcolor{preprocessor}{\#define stbiw\_\_zlib\_add(code, codebits)                                        \(\backslash\)}}
\DoxyCodeLine{944 \textcolor{preprocessor}{  (bitbuf |= (code) << bitcount, bitcount += (codebits), stbiw\_\_zlib\_flush())}}
\DoxyCodeLine{945 \textcolor{preprocessor}{\#define stbiw\_\_zlib\_huffa(b, c) stbiw\_\_zlib\_add(stbiw\_\_zlib\_bitrev(b, c), c)}}
\DoxyCodeLine{946 \textcolor{comment}{// default huffman tables}}
\DoxyCodeLine{947 \textcolor{preprocessor}{\#define stbiw\_\_zlib\_huff1(n) stbiw\_\_zlib\_huffa(0x30 + (n), 8)}}
\DoxyCodeLine{948 \textcolor{preprocessor}{\#define stbiw\_\_zlib\_huff2(n) stbiw\_\_zlib\_huffa(0x190 + (n)-\/144, 9)}}
\DoxyCodeLine{949 \textcolor{preprocessor}{\#define stbiw\_\_zlib\_huff3(n) stbiw\_\_zlib\_huffa(0 + (n)-\/256, 7)}}
\DoxyCodeLine{950 \textcolor{preprocessor}{\#define stbiw\_\_zlib\_huff4(n) stbiw\_\_zlib\_huffa(0xc0 + (n)-\/280, 8)}}
\DoxyCodeLine{951 \textcolor{preprocessor}{\#define stbiw\_\_zlib\_huff(n)                                                    \(\backslash\)}}
\DoxyCodeLine{952 \textcolor{preprocessor}{  ((n) <= 143   ? stbiw\_\_zlib\_huff1(n)                                         \(\backslash\)}}
\DoxyCodeLine{953 \textcolor{preprocessor}{   : (n) <= 255 ? stbiw\_\_zlib\_huff2(n)                                         \(\backslash\)}}
\DoxyCodeLine{954 \textcolor{preprocessor}{   : (n) <= 279 ? stbiw\_\_zlib\_huff3(n)                                         \(\backslash\)}}
\DoxyCodeLine{955 \textcolor{preprocessor}{                : stbiw\_\_zlib\_huff4(n))}}
\DoxyCodeLine{956 \textcolor{preprocessor}{\#define stbiw\_\_zlib\_huffb(n)                                                   \(\backslash\)}}
\DoxyCodeLine{957 \textcolor{preprocessor}{  ((n) <= 143 ? stbiw\_\_zlib\_huff1(n) : stbiw\_\_zlib\_huff2(n))}}
\DoxyCodeLine{958 }
\DoxyCodeLine{959 \textcolor{preprocessor}{\#define stbiw\_\_ZHASH 16384}}
\DoxyCodeLine{960 }
\DoxyCodeLine{961 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// STBIW\_ZLIB\_COMPRESS}}
\DoxyCodeLine{962 }
\DoxyCodeLine{963 STBIWDEF \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *stbi\_zlib\_compress(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *data, \textcolor{keywordtype}{int} data\_len,}
\DoxyCodeLine{964                                            \textcolor{keywordtype}{int} *out\_len, \textcolor{keywordtype}{int} quality) \{}
\DoxyCodeLine{965 \textcolor{preprocessor}{\#ifdef STBIW\_ZLIB\_COMPRESS}}
\DoxyCodeLine{966   \textcolor{comment}{// user provided a zlib compress implementation, use that}}
\DoxyCodeLine{967   \textcolor{keywordflow}{return} STBIW\_ZLIB\_COMPRESS(data, data\_len, out\_len, quality);}
\DoxyCodeLine{968 \textcolor{preprocessor}{\#else  }\textcolor{comment}{// use builtin}}
\DoxyCodeLine{969   \textcolor{keyword}{static} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} lengthc[] = \{}
\DoxyCodeLine{970       3,  4,  5,  6,  7,  8,  9,  10, 11,  13,  15,  17,  19,  23,  27,}
\DoxyCodeLine{971       31, 35, 43, 51, 59, 67, 83, 99, 115, 131, 163, 195, 227, 258, 259\};}
\DoxyCodeLine{972   \textcolor{keyword}{static} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} lengtheb[] = \{0, 0, 0, 0, 0, 0, 0, 0, 1, 1,}
\DoxyCodeLine{973                                      1, 1, 2, 2, 2, 2, 3, 3, 3, 3,}
\DoxyCodeLine{974                                      4, 4, 4, 4, 5, 5, 5, 5, 0\};}
\DoxyCodeLine{975   \textcolor{keyword}{static} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} distc[] = \{}
\DoxyCodeLine{976       1,    2,    3,    4,    5,    7,     9,     13,    17,   25,   33,}
\DoxyCodeLine{977       49,   65,   97,   129,  193,  257,   385,   513,   769,  1025, 1537,}
\DoxyCodeLine{978       2049, 3073, 4097, 6145, 8193, 12289, 16385, 24577, 32768\};}
\DoxyCodeLine{979   \textcolor{keyword}{static} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} disteb[] = \{0, 0, 0,  0,  1,  1,  2,  2,  3,  3,}
\DoxyCodeLine{980                                    4, 4, 5,  5,  6,  6,  7,  7,  8,  8,}
\DoxyCodeLine{981                                    9, 9, 10, 10, 11, 11, 12, 12, 13, 13\};}
\DoxyCodeLine{982   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} bitbuf = 0;}
\DoxyCodeLine{983   \textcolor{keywordtype}{int} i, j, bitcount = 0;}
\DoxyCodeLine{984   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *out = NULL;}
\DoxyCodeLine{985   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} ***hash\_table =}
\DoxyCodeLine{986       (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} ***)STBIW\_MALLOC(stbiw\_\_ZHASH * \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} **));}
\DoxyCodeLine{987   \textcolor{keywordflow}{if} (hash\_table == NULL)}
\DoxyCodeLine{988     \textcolor{keywordflow}{return} NULL;}
\DoxyCodeLine{989   \textcolor{keywordflow}{if} (quality < 5)}
\DoxyCodeLine{990     quality = 5;}
\DoxyCodeLine{991 }
\DoxyCodeLine{992   stbiw\_\_sbpush(out, 0x78); \textcolor{comment}{// DEFLATE 32K window}}
\DoxyCodeLine{993   stbiw\_\_sbpush(out, 0x5e); \textcolor{comment}{// FLEVEL = 1}}
\DoxyCodeLine{994   stbiw\_\_zlib\_add(1, 1);    \textcolor{comment}{// BFINAL = 1}}
\DoxyCodeLine{995   stbiw\_\_zlib\_add(1, 2);    \textcolor{comment}{// BTYPE = 1 -\/-\/ fixed huffman}}
\DoxyCodeLine{996 }
\DoxyCodeLine{997   \textcolor{keywordflow}{for} (i = 0; i < stbiw\_\_ZHASH; ++i)}
\DoxyCodeLine{998     hash\_table[i] = NULL;}
\DoxyCodeLine{999 }
\DoxyCodeLine{1000   i = 0;}
\DoxyCodeLine{1001   \textcolor{keywordflow}{while} (i < data\_len -\/ 3) \{}
\DoxyCodeLine{1002     \textcolor{comment}{// hash next 3 bytes of data to be compressed}}
\DoxyCodeLine{1003     \textcolor{keywordtype}{int} h = stbiw\_\_zhash(data + i) \& (stbiw\_\_ZHASH -\/ 1), best = 3;}
\DoxyCodeLine{1004     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *bestloc = 0;}
\DoxyCodeLine{1005     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} **hlist = hash\_table[h];}
\DoxyCodeLine{1006     \textcolor{keywordtype}{int} n = stbiw\_\_sbcount(hlist);}
\DoxyCodeLine{1007     \textcolor{keywordflow}{for} (j = 0; j < n; ++j) \{}
\DoxyCodeLine{1008       \textcolor{keywordflow}{if} (hlist[j] -\/ data > i -\/ 32768) \{ \textcolor{comment}{// if entry lies within window}}
\DoxyCodeLine{1009         \textcolor{keywordtype}{int} d = stbiw\_\_zlib\_countm(hlist[j], data + i, data\_len -\/ i);}
\DoxyCodeLine{1010         \textcolor{keywordflow}{if} (d >= best) \{}
\DoxyCodeLine{1011           best = d;}
\DoxyCodeLine{1012           bestloc = hlist[j];}
\DoxyCodeLine{1013         \}}
\DoxyCodeLine{1014       \}}
\DoxyCodeLine{1015     \}}
\DoxyCodeLine{1016     \textcolor{comment}{// when hash table entry is too long, delete half the entries}}
\DoxyCodeLine{1017     \textcolor{keywordflow}{if} (hash\_table[h] \&\& stbiw\_\_sbn(hash\_table[h]) == 2 * quality) \{}
\DoxyCodeLine{1018       STBIW\_MEMMOVE(hash\_table[h], hash\_table[h] + quality,}
\DoxyCodeLine{1019                     \textcolor{keyword}{sizeof}(hash\_table[h][0]) * quality);}
\DoxyCodeLine{1020       stbiw\_\_sbn(hash\_table[h]) = quality;}
\DoxyCodeLine{1021     \}}
\DoxyCodeLine{1022     stbiw\_\_sbpush(hash\_table[h], data + i);}
\DoxyCodeLine{1023 }
\DoxyCodeLine{1024     \textcolor{keywordflow}{if} (bestloc) \{}
\DoxyCodeLine{1025       \textcolor{comment}{// "{}lazy matching"{} -\/ check match at *next* byte, and if it's better, do}}
\DoxyCodeLine{1026       \textcolor{comment}{// cur byte as literal}}
\DoxyCodeLine{1027       h = stbiw\_\_zhash(data + i + 1) \& (stbiw\_\_ZHASH -\/ 1);}
\DoxyCodeLine{1028       hlist = hash\_table[h];}
\DoxyCodeLine{1029       n = stbiw\_\_sbcount(hlist);}
\DoxyCodeLine{1030       \textcolor{keywordflow}{for} (j = 0; j < n; ++j) \{}
\DoxyCodeLine{1031         \textcolor{keywordflow}{if} (hlist[j] -\/ data > i -\/ 32767) \{}
\DoxyCodeLine{1032           \textcolor{keywordtype}{int} e = stbiw\_\_zlib\_countm(hlist[j], data + i + 1, data\_len -\/ i -\/ 1);}
\DoxyCodeLine{1033           \textcolor{keywordflow}{if} (e > best) \{ \textcolor{comment}{// if next match is better, bail on current match}}
\DoxyCodeLine{1034             bestloc = NULL;}
\DoxyCodeLine{1035             \textcolor{keywordflow}{break};}
\DoxyCodeLine{1036           \}}
\DoxyCodeLine{1037         \}}
\DoxyCodeLine{1038       \}}
\DoxyCodeLine{1039     \}}
\DoxyCodeLine{1040 }
\DoxyCodeLine{1041     \textcolor{keywordflow}{if} (bestloc) \{}
\DoxyCodeLine{1042       \textcolor{keywordtype}{int} d = (int)(data + i -\/ bestloc); \textcolor{comment}{// distance back}}
\DoxyCodeLine{1043       STBIW\_ASSERT(d <= 32767 \&\& best <= 258);}
\DoxyCodeLine{1044       \textcolor{keywordflow}{for} (j = 0; best > lengthc[j + 1] -\/ 1; ++j)}
\DoxyCodeLine{1045         ;}
\DoxyCodeLine{1046       stbiw\_\_zlib\_huff(j + 257);}
\DoxyCodeLine{1047       \textcolor{keywordflow}{if} (lengtheb[j])}
\DoxyCodeLine{1048         stbiw\_\_zlib\_add(best -\/ lengthc[j], lengtheb[j]);}
\DoxyCodeLine{1049       \textcolor{keywordflow}{for} (j = 0; d > distc[j + 1] -\/ 1; ++j)}
\DoxyCodeLine{1050         ;}
\DoxyCodeLine{1051       stbiw\_\_zlib\_add(stbiw\_\_zlib\_bitrev(j, 5), 5);}
\DoxyCodeLine{1052       \textcolor{keywordflow}{if} (disteb[j])}
\DoxyCodeLine{1053         stbiw\_\_zlib\_add(d -\/ distc[j], disteb[j]);}
\DoxyCodeLine{1054       i += best;}
\DoxyCodeLine{1055     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{1056       stbiw\_\_zlib\_huffb(data[i]);}
\DoxyCodeLine{1057       ++i;}
\DoxyCodeLine{1058     \}}
\DoxyCodeLine{1059   \}}
\DoxyCodeLine{1060   \textcolor{comment}{// write out final bytes}}
\DoxyCodeLine{1061   \textcolor{keywordflow}{for} (; i < data\_len; ++i)}
\DoxyCodeLine{1062     stbiw\_\_zlib\_huffb(data[i]);}
\DoxyCodeLine{1063   stbiw\_\_zlib\_huff(256); \textcolor{comment}{// end of block}}
\DoxyCodeLine{1064   \textcolor{comment}{// pad with 0 bits to byte boundary}}
\DoxyCodeLine{1065   \textcolor{keywordflow}{while} (bitcount)}
\DoxyCodeLine{1066     stbiw\_\_zlib\_add(0, 1);}
\DoxyCodeLine{1067 }
\DoxyCodeLine{1068   \textcolor{keywordflow}{for} (i = 0; i < stbiw\_\_ZHASH; ++i)}
\DoxyCodeLine{1069     (\textcolor{keywordtype}{void})stbiw\_\_sbfree(hash\_table[i]);}
\DoxyCodeLine{1070   STBIW\_FREE(hash\_table);}
\DoxyCodeLine{1071 }
\DoxyCodeLine{1072   \textcolor{comment}{// store uncompressed instead if compression was worse}}
\DoxyCodeLine{1073   \textcolor{keywordflow}{if} (stbiw\_\_sbn(out) > data\_len + 2 + ((data\_len + 32766) / 32767) * 5) \{}
\DoxyCodeLine{1074     stbiw\_\_sbn(out) = 2; \textcolor{comment}{// truncate to DEFLATE 32K window and FLEVEL = 1}}
\DoxyCodeLine{1075     \textcolor{keywordflow}{for} (j = 0; j < data\_len;) \{}
\DoxyCodeLine{1076       \textcolor{keywordtype}{int} blocklen = data\_len -\/ j;}
\DoxyCodeLine{1077       \textcolor{keywordflow}{if} (blocklen > 32767)}
\DoxyCodeLine{1078         blocklen = 32767;}
\DoxyCodeLine{1079       stbiw\_\_sbpush(out,}
\DoxyCodeLine{1080                     data\_len -\/ j ==}
\DoxyCodeLine{1081                         blocklen); \textcolor{comment}{// BFINAL = ?, BTYPE = 0 -\/-\/ no compression}}
\DoxyCodeLine{1082       stbiw\_\_sbpush(out, STBIW\_UCHAR(blocklen)); \textcolor{comment}{// LEN}}
\DoxyCodeLine{1083       stbiw\_\_sbpush(out, STBIW\_UCHAR(blocklen >> 8));}
\DoxyCodeLine{1084       stbiw\_\_sbpush(out, STBIW\_UCHAR(\string~blocklen)); \textcolor{comment}{// NLEN}}
\DoxyCodeLine{1085       stbiw\_\_sbpush(out, STBIW\_UCHAR(\string~blocklen >> 8));}
\DoxyCodeLine{1086       memcpy(out + stbiw\_\_sbn(out), data + j, blocklen);}
\DoxyCodeLine{1087       stbiw\_\_sbn(out) += blocklen;}
\DoxyCodeLine{1088       j += blocklen;}
\DoxyCodeLine{1089     \}}
\DoxyCodeLine{1090   \}}
\DoxyCodeLine{1091 }
\DoxyCodeLine{1092   \{}
\DoxyCodeLine{1093     \textcolor{comment}{// compute adler32 on input}}
\DoxyCodeLine{1094     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} s1 = 1, s2 = 0;}
\DoxyCodeLine{1095     \textcolor{keywordtype}{int} blocklen = (int)(data\_len \% 5552);}
\DoxyCodeLine{1096     j = 0;}
\DoxyCodeLine{1097     \textcolor{keywordflow}{while} (j < data\_len) \{}
\DoxyCodeLine{1098       \textcolor{keywordflow}{for} (i = 0; i < blocklen; ++i) \{}
\DoxyCodeLine{1099         s1 += data[j + i];}
\DoxyCodeLine{1100         s2 += s1;}
\DoxyCodeLine{1101       \}}
\DoxyCodeLine{1102       s1 \%= 65521;}
\DoxyCodeLine{1103       s2 \%= 65521;}
\DoxyCodeLine{1104       j += blocklen;}
\DoxyCodeLine{1105       blocklen = 5552;}
\DoxyCodeLine{1106     \}}
\DoxyCodeLine{1107     stbiw\_\_sbpush(out, STBIW\_UCHAR(s2 >> 8));}
\DoxyCodeLine{1108     stbiw\_\_sbpush(out, STBIW\_UCHAR(s2));}
\DoxyCodeLine{1109     stbiw\_\_sbpush(out, STBIW\_UCHAR(s1 >> 8));}
\DoxyCodeLine{1110     stbiw\_\_sbpush(out, STBIW\_UCHAR(s1));}
\DoxyCodeLine{1111   \}}
\DoxyCodeLine{1112   *out\_len = stbiw\_\_sbn(out);}
\DoxyCodeLine{1113   \textcolor{comment}{// make returned pointer freeable}}
\DoxyCodeLine{1114   STBIW\_MEMMOVE(stbiw\_\_sbraw(out), out, *out\_len);}
\DoxyCodeLine{1115   \textcolor{keywordflow}{return} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *)stbiw\_\_sbraw(out);}
\DoxyCodeLine{1116 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// STBIW\_ZLIB\_COMPRESS}}
\DoxyCodeLine{1117 \}}
\DoxyCodeLine{1118 }
\DoxyCodeLine{1119 \textcolor{keyword}{static} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} stbiw\_\_crc32(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *buffer, \textcolor{keywordtype}{int} len) \{}
\DoxyCodeLine{1120 \textcolor{preprocessor}{\#ifdef STBIW\_CRC32}}
\DoxyCodeLine{1121   \textcolor{keywordflow}{return} STBIW\_CRC32(buffer, len);}
\DoxyCodeLine{1122 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{1123   \textcolor{keyword}{static} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} crc\_table[256] = \{}
\DoxyCodeLine{1124       0x00000000, 0x77073096, 0xEE0E612C, 0x990951BA, 0x076DC419, 0x706AF48F,}
\DoxyCodeLine{1125       0xE963A535, 0x9E6495A3, 0x0eDB8832, 0x79DCB8A4, 0xE0D5E91E, 0x97D2D988,}
\DoxyCodeLine{1126       0x09B64C2B, 0x7EB17CBD, 0xE7B82D07, 0x90BF1D91, 0x1DB71064, 0x6AB020F2,}
\DoxyCodeLine{1127       0xF3B97148, 0x84BE41DE, 0x1ADAD47D, 0x6DDDE4EB, 0xF4D4B551, 0x83D385C7,}
\DoxyCodeLine{1128       0x136C9856, 0x646BA8C0, 0xFD62F97A, 0x8A65C9EC, 0x14015C4F, 0x63066CD9,}
\DoxyCodeLine{1129       0xFA0F3D63, 0x8D080DF5, 0x3B6E20C8, 0x4C69105E, 0xD56041E4, 0xA2677172,}
\DoxyCodeLine{1130       0x3C03E4D1, 0x4B04D447, 0xD20D85FD, 0xA50AB56B, 0x35B5A8FA, 0x42B2986C,}
\DoxyCodeLine{1131       0xDBBBC9D6, 0xACBCF940, 0x32D86CE3, 0x45DF5C75, 0xDCD60DCF, 0xABD13D59,}
\DoxyCodeLine{1132       0x26D930AC, 0x51DE003A, 0xC8D75180, 0xBFD06116, 0x21B4F4B5, 0x56B3C423,}
\DoxyCodeLine{1133       0xCFBA9599, 0xB8BDA50F, 0x2802B89E, 0x5F058808, 0xC60CD9B2, 0xB10BE924,}
\DoxyCodeLine{1134       0x2F6F7C87, 0x58684C11, 0xC1611DAB, 0xB6662D3D, 0x76DC4190, 0x01DB7106,}
\DoxyCodeLine{1135       0x98D220BC, 0xEFD5102A, 0x71B18589, 0x06B6B51F, 0x9FBFE4A5, 0xE8B8D433,}
\DoxyCodeLine{1136       0x7807C9A2, 0x0F00F934, 0x9609A88E, 0xE10E9818, 0x7F6A0DBB, 0x086D3D2D,}
\DoxyCodeLine{1137       0x91646C97, 0xE6635C01, 0x6B6B51F4, 0x1C6C6162, 0x856530D8, 0xF262004E,}
\DoxyCodeLine{1138       0x6C0695ED, 0x1B01A57B, 0x8208F4C1, 0xF50FC457, 0x65B0D9C6, 0x12B7E950,}
\DoxyCodeLine{1139       0x8BBEB8EA, 0xFCB9887C, 0x62DD1DDF, 0x15DA2D49, 0x8CD37CF3, 0xFBD44C65,}
\DoxyCodeLine{1140       0x4DB26158, 0x3AB551CE, 0xA3BC0074, 0xD4BB30E2, 0x4ADFA541, 0x3DD895D7,}
\DoxyCodeLine{1141       0xA4D1C46D, 0xD3D6F4FB, 0x4369E96A, 0x346ED9FC, 0xAD678846, 0xDA60B8D0,}
\DoxyCodeLine{1142       0x44042D73, 0x33031DE5, 0xAA0A4C5F, 0xDD0D7CC9, 0x5005713C, 0x270241AA,}
\DoxyCodeLine{1143       0xBE0B1010, 0xC90C2086, 0x5768B525, 0x206F85B3, 0xB966D409, 0xCE61E49F,}
\DoxyCodeLine{1144       0x5EDEF90E, 0x29D9C998, 0xB0D09822, 0xC7D7A8B4, 0x59B33D17, 0x2EB40D81,}
\DoxyCodeLine{1145       0xB7BD5C3B, 0xC0BA6CAD, 0xEDB88320, 0x9ABFB3B6, 0x03B6E20C, 0x74B1D29A,}
\DoxyCodeLine{1146       0xEAD54739, 0x9DD277AF, 0x04DB2615, 0x73DC1683, 0xE3630B12, 0x94643B84,}
\DoxyCodeLine{1147       0x0D6D6A3E, 0x7A6A5AA8, 0xE40ECF0B, 0x9309FF9D, 0x0A00AE27, 0x7D079EB1,}
\DoxyCodeLine{1148       0xF00F9344, 0x8708A3D2, 0x1E01F268, 0x6906C2FE, 0xF762575D, 0x806567CB,}
\DoxyCodeLine{1149       0x196C3671, 0x6E6B06E7, 0xFED41B76, 0x89D32BE0, 0x10DA7A5A, 0x67DD4ACC,}
\DoxyCodeLine{1150       0xF9B9DF6F, 0x8EBEEFF9, 0x17B7BE43, 0x60B08ED5, 0xD6D6A3E8, 0xA1D1937E,}
\DoxyCodeLine{1151       0x38D8C2C4, 0x4FDFF252, 0xD1BB67F1, 0xA6BC5767, 0x3FB506DD, 0x48B2364B,}
\DoxyCodeLine{1152       0xD80D2BDA, 0xAF0A1B4C, 0x36034AF6, 0x41047A60, 0xDF60EFC3, 0xA867DF55,}
\DoxyCodeLine{1153       0x316E8EEF, 0x4669BE79, 0xCB61B38C, 0xBC66831A, 0x256FD2A0, 0x5268E236,}
\DoxyCodeLine{1154       0xCC0C7795, 0xBB0B4703, 0x220216B9, 0x5505262F, 0xC5BA3BBE, 0xB2BD0B28,}
\DoxyCodeLine{1155       0x2BB45A92, 0x5CB36A04, 0xC2D7FFA7, 0xB5D0CF31, 0x2CD99E8B, 0x5BDEAE1D,}
\DoxyCodeLine{1156       0x9B64C2B0, 0xEC63F226, 0x756AA39C, 0x026D930A, 0x9C0906A9, 0xEB0E363F,}
\DoxyCodeLine{1157       0x72076785, 0x05005713, 0x95BF4A82, 0xE2B87A14, 0x7BB12BAE, 0x0CB61B38,}
\DoxyCodeLine{1158       0x92D28E9B, 0xE5D5BE0D, 0x7CDCEFB7, 0x0BDBDF21, 0x86D3D2D4, 0xF1D4E242,}
\DoxyCodeLine{1159       0x68DDB3F8, 0x1FDA836E, 0x81BE16CD, 0xF6B9265B, 0x6FB077E1, 0x18B74777,}
\DoxyCodeLine{1160       0x88085AE6, 0xFF0F6A70, 0x66063BCA, 0x11010B5C, 0x8F659EFF, 0xF862AE69,}
\DoxyCodeLine{1161       0x616BFFD3, 0x166CCF45, 0xA00AE278, 0xD70DD2EE, 0x4E048354, 0x3903B3C2,}
\DoxyCodeLine{1162       0xA7672661, 0xD06016F7, 0x4969474D, 0x3E6E77DB, 0xAED16A4A, 0xD9D65ADC,}
\DoxyCodeLine{1163       0x40DF0B66, 0x37D83BF0, 0xA9BCAE53, 0xDEBB9EC5, 0x47B2CF7F, 0x30B5FFE9,}
\DoxyCodeLine{1164       0xBDBDF21C, 0xCABAC28A, 0x53B39330, 0x24B4A3A6, 0xBAD03605, 0xCDD70693,}
\DoxyCodeLine{1165       0x54DE5729, 0x23D967BF, 0xB3667A2E, 0xC4614AB8, 0x5D681B02, 0x2A6F2B94,}
\DoxyCodeLine{1166       0xB40BBE37, 0xC30C8EA1, 0x5A05DF1B, 0x2D02EF8D\};}
\DoxyCodeLine{1167 }
\DoxyCodeLine{1168   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} crc = \string~0u;}
\DoxyCodeLine{1169   \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{1170   \textcolor{keywordflow}{for} (i = 0; i < len; ++i)}
\DoxyCodeLine{1171     crc = (crc >> 8) \string^ crc\_table[buffer[i] \string^ (crc \& 0xff)];}
\DoxyCodeLine{1172   \textcolor{keywordflow}{return} \string~crc;}
\DoxyCodeLine{1173 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1174 \}}
\DoxyCodeLine{1175 }
\DoxyCodeLine{1176 \textcolor{preprocessor}{\#define stbiw\_\_wpng4(o, a, b, c, d)                                            \(\backslash\)}}
\DoxyCodeLine{1177 \textcolor{preprocessor}{  ((o)[0] = STBIW\_UCHAR(a), (o)[1] = STBIW\_UCHAR(b), (o)[2] = STBIW\_UCHAR(c),  \(\backslash\)}}
\DoxyCodeLine{1178 \textcolor{preprocessor}{   (o)[3] = STBIW\_UCHAR(d), (o) += 4)}}
\DoxyCodeLine{1179 \textcolor{preprocessor}{\#define stbiw\_\_wp32(data, v)                                                   \(\backslash\)}}
\DoxyCodeLine{1180 \textcolor{preprocessor}{  stbiw\_\_wpng4(data, (v) >> 24, (v) >> 16, (v) >> 8, (v));}}
\DoxyCodeLine{1181 \textcolor{preprocessor}{\#define stbiw\_\_wptag(data, s) stbiw\_\_wpng4(data, s[0], s[1], s[2], s[3])}}
\DoxyCodeLine{1182 }
\DoxyCodeLine{1183 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbiw\_\_wpcrc(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} **data, \textcolor{keywordtype}{int} len) \{}
\DoxyCodeLine{1184   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} crc = stbiw\_\_crc32(*data -\/ len -\/ 4, len + 4);}
\DoxyCodeLine{1185   stbiw\_\_wp32(*data, crc);}
\DoxyCodeLine{1186 \}}
\DoxyCodeLine{1187 }
\DoxyCodeLine{1188 \textcolor{keyword}{static} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} stbiw\_\_paeth(\textcolor{keywordtype}{int} a, \textcolor{keywordtype}{int} b, \textcolor{keywordtype}{int} c) \{}
\DoxyCodeLine{1189   \textcolor{keywordtype}{int} p = a + b -\/ c, pa = abs(p -\/ a), pb = abs(p -\/ b), pc = abs(p -\/ c);}
\DoxyCodeLine{1190   \textcolor{keywordflow}{if} (pa <= pb \&\& pa <= pc)}
\DoxyCodeLine{1191     \textcolor{keywordflow}{return} STBIW\_UCHAR(a);}
\DoxyCodeLine{1192   \textcolor{keywordflow}{if} (pb <= pc)}
\DoxyCodeLine{1193     \textcolor{keywordflow}{return} STBIW\_UCHAR(b);}
\DoxyCodeLine{1194   \textcolor{keywordflow}{return} STBIW\_UCHAR(c);}
\DoxyCodeLine{1195 \}}
\DoxyCodeLine{1196 }
\DoxyCodeLine{1197 \textcolor{comment}{// @OPTIMIZE: provide an option that always forces left-\/predict or paeth predict}}
\DoxyCodeLine{1198 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbiw\_\_encode\_png\_line(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *pixels, \textcolor{keywordtype}{int} stride\_bytes,}
\DoxyCodeLine{1199                                    \textcolor{keywordtype}{int} width, \textcolor{keywordtype}{int} height, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} n,}
\DoxyCodeLine{1200                                    \textcolor{keywordtype}{int} filter\_type, \textcolor{keywordtype}{signed} \textcolor{keywordtype}{char} *line\_buffer) \{}
\DoxyCodeLine{1201   \textcolor{keyword}{static} \textcolor{keywordtype}{int} mapping[] = \{0, 1, 2, 3, 4\};}
\DoxyCodeLine{1202   \textcolor{keyword}{static} \textcolor{keywordtype}{int} firstmap[] = \{0, 1, 0, 5, 6\};}
\DoxyCodeLine{1203   \textcolor{keywordtype}{int} *mymap = (y != 0) ? mapping : firstmap;}
\DoxyCodeLine{1204   \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{1205   \textcolor{keywordtype}{int} type = mymap[filter\_type];}
\DoxyCodeLine{1206   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *z =}
\DoxyCodeLine{1207       pixels +}
\DoxyCodeLine{1208       stride\_bytes * (stbi\_\_flip\_vertically\_on\_write ? height -\/ 1 -\/ y : y);}
\DoxyCodeLine{1209   \textcolor{keywordtype}{int} signed\_stride =}
\DoxyCodeLine{1210       stbi\_\_flip\_vertically\_on\_write ? -\/stride\_bytes : stride\_bytes;}
\DoxyCodeLine{1211 }
\DoxyCodeLine{1212   \textcolor{keywordflow}{if} (type == 0) \{}
\DoxyCodeLine{1213     memcpy(line\_buffer, z, width * n);}
\DoxyCodeLine{1214     \textcolor{keywordflow}{return};}
\DoxyCodeLine{1215   \}}
\DoxyCodeLine{1216 }
\DoxyCodeLine{1217   \textcolor{comment}{// first loop isn't optimized since it's just one pixel}}
\DoxyCodeLine{1218   \textcolor{keywordflow}{for} (i = 0; i < n; ++i) \{}
\DoxyCodeLine{1219     \textcolor{keywordflow}{switch} (type) \{}
\DoxyCodeLine{1220     \textcolor{keywordflow}{case} 1:}
\DoxyCodeLine{1221       line\_buffer[i] = z[i];}
\DoxyCodeLine{1222       \textcolor{keywordflow}{break};}
\DoxyCodeLine{1223     \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{1224       line\_buffer[i] = z[i] -\/ z[i -\/ signed\_stride];}
\DoxyCodeLine{1225       \textcolor{keywordflow}{break};}
\DoxyCodeLine{1226     \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{1227       line\_buffer[i] = z[i] -\/ (z[i -\/ signed\_stride] >> 1);}
\DoxyCodeLine{1228       \textcolor{keywordflow}{break};}
\DoxyCodeLine{1229     \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{1230       line\_buffer[i] =}
\DoxyCodeLine{1231           (\textcolor{keywordtype}{signed} char)(z[i] -\/ stbiw\_\_paeth(0, z[i -\/ signed\_stride], 0));}
\DoxyCodeLine{1232       \textcolor{keywordflow}{break};}
\DoxyCodeLine{1233     \textcolor{keywordflow}{case} 5:}
\DoxyCodeLine{1234       line\_buffer[i] = z[i];}
\DoxyCodeLine{1235       \textcolor{keywordflow}{break};}
\DoxyCodeLine{1236     \textcolor{keywordflow}{case} 6:}
\DoxyCodeLine{1237       line\_buffer[i] = z[i];}
\DoxyCodeLine{1238       \textcolor{keywordflow}{break};}
\DoxyCodeLine{1239     \}}
\DoxyCodeLine{1240   \}}
\DoxyCodeLine{1241   \textcolor{keywordflow}{switch} (type) \{}
\DoxyCodeLine{1242   \textcolor{keywordflow}{case} 1:}
\DoxyCodeLine{1243     \textcolor{keywordflow}{for} (i = n; i < width * n; ++i)}
\DoxyCodeLine{1244       line\_buffer[i] = z[i] -\/ z[i -\/ n];}
\DoxyCodeLine{1245     \textcolor{keywordflow}{break};}
\DoxyCodeLine{1246   \textcolor{keywordflow}{case} 2:}
\DoxyCodeLine{1247     \textcolor{keywordflow}{for} (i = n; i < width * n; ++i)}
\DoxyCodeLine{1248       line\_buffer[i] = z[i] -\/ z[i -\/ signed\_stride];}
\DoxyCodeLine{1249     \textcolor{keywordflow}{break};}
\DoxyCodeLine{1250   \textcolor{keywordflow}{case} 3:}
\DoxyCodeLine{1251     \textcolor{keywordflow}{for} (i = n; i < width * n; ++i)}
\DoxyCodeLine{1252       line\_buffer[i] = z[i] -\/ ((z[i -\/ n] + z[i -\/ signed\_stride]) >> 1);}
\DoxyCodeLine{1253     \textcolor{keywordflow}{break};}
\DoxyCodeLine{1254   \textcolor{keywordflow}{case} 4:}
\DoxyCodeLine{1255     \textcolor{keywordflow}{for} (i = n; i < width * n; ++i)}
\DoxyCodeLine{1256       line\_buffer[i] = z[i] -\/ stbiw\_\_paeth(z[i -\/ n], z[i -\/ signed\_stride],}
\DoxyCodeLine{1257                                            z[i -\/ signed\_stride -\/ n]);}
\DoxyCodeLine{1258     \textcolor{keywordflow}{break};}
\DoxyCodeLine{1259   \textcolor{keywordflow}{case} 5:}
\DoxyCodeLine{1260     \textcolor{keywordflow}{for} (i = n; i < width * n; ++i)}
\DoxyCodeLine{1261       line\_buffer[i] = z[i] -\/ (z[i -\/ n] >> 1);}
\DoxyCodeLine{1262     \textcolor{keywordflow}{break};}
\DoxyCodeLine{1263   \textcolor{keywordflow}{case} 6:}
\DoxyCodeLine{1264     \textcolor{keywordflow}{for} (i = n; i < width * n; ++i)}
\DoxyCodeLine{1265       line\_buffer[i] = z[i] -\/ stbiw\_\_paeth(z[i -\/ n], 0, 0);}
\DoxyCodeLine{1266     \textcolor{keywordflow}{break};}
\DoxyCodeLine{1267   \}}
\DoxyCodeLine{1268 \}}
\DoxyCodeLine{1269 }
\DoxyCodeLine{1270 STBIWDEF \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *stbi\_write\_png\_to\_mem(\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *pixels,}
\DoxyCodeLine{1271                                               \textcolor{keywordtype}{int} stride\_bytes, \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y,}
\DoxyCodeLine{1272                                               \textcolor{keywordtype}{int} n, \textcolor{keywordtype}{int} *out\_len) \{}
\DoxyCodeLine{1273   \textcolor{keywordtype}{int} force\_filter = stbi\_write\_force\_png\_filter;}
\DoxyCodeLine{1274   \textcolor{keywordtype}{int} ctype[5] = \{-\/1, 0, 4, 2, 6\};}
\DoxyCodeLine{1275   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} sig[8] = \{137, 80, 78, 71, 13, 10, 26, 10\};}
\DoxyCodeLine{1276   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *out, *o, *filt, *zlib;}
\DoxyCodeLine{1277   \textcolor{keywordtype}{signed} \textcolor{keywordtype}{char} *line\_buffer;}
\DoxyCodeLine{1278   \textcolor{keywordtype}{int} j, zlen;}
\DoxyCodeLine{1279 }
\DoxyCodeLine{1280   \textcolor{keywordflow}{if} (stride\_bytes == 0)}
\DoxyCodeLine{1281     stride\_bytes = x * n;}
\DoxyCodeLine{1282 }
\DoxyCodeLine{1283   \textcolor{keywordflow}{if} (force\_filter >= 5) \{}
\DoxyCodeLine{1284     force\_filter = -\/1;}
\DoxyCodeLine{1285   \}}
\DoxyCodeLine{1286 }
\DoxyCodeLine{1287   filt = (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *)STBIW\_MALLOC((x * n + 1) * y);}
\DoxyCodeLine{1288   \textcolor{keywordflow}{if} (!filt)}
\DoxyCodeLine{1289     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{1290   line\_buffer = (\textcolor{keywordtype}{signed} \textcolor{keywordtype}{char} *)STBIW\_MALLOC(x * n);}
\DoxyCodeLine{1291   \textcolor{keywordflow}{if} (!line\_buffer) \{}
\DoxyCodeLine{1292     STBIW\_FREE(filt);}
\DoxyCodeLine{1293     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{1294   \}}
\DoxyCodeLine{1295   \textcolor{keywordflow}{for} (j = 0; j < y; ++j) \{}
\DoxyCodeLine{1296     \textcolor{keywordtype}{int} filter\_type;}
\DoxyCodeLine{1297     \textcolor{keywordflow}{if} (force\_filter > -\/1) \{}
\DoxyCodeLine{1298       filter\_type = force\_filter;}
\DoxyCodeLine{1299       stbiw\_\_encode\_png\_line((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *)(pixels), stride\_bytes, x, y, j,}
\DoxyCodeLine{1300                              n, force\_filter, line\_buffer);}
\DoxyCodeLine{1301     \} \textcolor{keywordflow}{else} \{ \textcolor{comment}{// Estimate the best filter by running through all of them:}}
\DoxyCodeLine{1302       \textcolor{keywordtype}{int} best\_filter = 0, best\_filter\_val = 0x7fffffff, est, i;}
\DoxyCodeLine{1303       \textcolor{keywordflow}{for} (filter\_type = 0; filter\_type < 5; filter\_type++) \{}
\DoxyCodeLine{1304         stbiw\_\_encode\_png\_line((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *)(pixels), stride\_bytes, x, y, j,}
\DoxyCodeLine{1305                                n, filter\_type, line\_buffer);}
\DoxyCodeLine{1306 }
\DoxyCodeLine{1307         \textcolor{comment}{// Estimate the entropy of the line using this filter; the less, the}}
\DoxyCodeLine{1308         \textcolor{comment}{// better.}}
\DoxyCodeLine{1309         est = 0;}
\DoxyCodeLine{1310         \textcolor{keywordflow}{for} (i = 0; i < x * n; ++i) \{}
\DoxyCodeLine{1311           est += abs((\textcolor{keywordtype}{signed} \textcolor{keywordtype}{char})line\_buffer[i]);}
\DoxyCodeLine{1312         \}}
\DoxyCodeLine{1313         \textcolor{keywordflow}{if} (est < best\_filter\_val) \{}
\DoxyCodeLine{1314           best\_filter\_val = est;}
\DoxyCodeLine{1315           best\_filter = filter\_type;}
\DoxyCodeLine{1316         \}}
\DoxyCodeLine{1317       \}}
\DoxyCodeLine{1318       \textcolor{keywordflow}{if} (filter\_type != best\_filter) \{ \textcolor{comment}{// If the last iteration already got us}}
\DoxyCodeLine{1319                                         \textcolor{comment}{// the best filter, don't redo it}}
\DoxyCodeLine{1320         stbiw\_\_encode\_png\_line((\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *)(pixels), stride\_bytes, x, y, j,}
\DoxyCodeLine{1321                                n, best\_filter, line\_buffer);}
\DoxyCodeLine{1322         filter\_type = best\_filter;}
\DoxyCodeLine{1323       \}}
\DoxyCodeLine{1324     \}}
\DoxyCodeLine{1325     \textcolor{comment}{// when we get here, filter\_type contains the filter type, and line\_buffer}}
\DoxyCodeLine{1326     \textcolor{comment}{// contains the data}}
\DoxyCodeLine{1327     filt[j * (x * n + 1)] = (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char})filter\_type;}
\DoxyCodeLine{1328     STBIW\_MEMMOVE(filt + j * (x * n + 1) + 1, line\_buffer, x * n);}
\DoxyCodeLine{1329   \}}
\DoxyCodeLine{1330   STBIW\_FREE(line\_buffer);}
\DoxyCodeLine{1331   zlib = stbi\_zlib\_compress(filt, y * (x * n + 1), \&zlen,}
\DoxyCodeLine{1332                             stbi\_write\_png\_compression\_level);}
\DoxyCodeLine{1333   STBIW\_FREE(filt);}
\DoxyCodeLine{1334   \textcolor{keywordflow}{if} (!zlib)}
\DoxyCodeLine{1335     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{1336 }
\DoxyCodeLine{1337   \textcolor{comment}{// each tag requires 12 bytes of overhead}}
\DoxyCodeLine{1338   out = (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *)STBIW\_MALLOC(8 + 12 + 13 + 12 + zlen + 12);}
\DoxyCodeLine{1339   \textcolor{keywordflow}{if} (!out)}
\DoxyCodeLine{1340     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{1341   *out\_len = 8 + 12 + 13 + 12 + zlen + 12;}
\DoxyCodeLine{1342 }
\DoxyCodeLine{1343   o = out;}
\DoxyCodeLine{1344   STBIW\_MEMMOVE(o, sig, 8);}
\DoxyCodeLine{1345   o += 8;}
\DoxyCodeLine{1346   stbiw\_\_wp32(o, 13); \textcolor{comment}{// header length}}
\DoxyCodeLine{1347   stbiw\_\_wptag(o, \textcolor{stringliteral}{"{}IHDR"{}});}
\DoxyCodeLine{1348   stbiw\_\_wp32(o, x);}
\DoxyCodeLine{1349   stbiw\_\_wp32(o, y);}
\DoxyCodeLine{1350   *o++ = 8;}
\DoxyCodeLine{1351   *o++ = STBIW\_UCHAR(ctype[n]);}
\DoxyCodeLine{1352   *o++ = 0;}
\DoxyCodeLine{1353   *o++ = 0;}
\DoxyCodeLine{1354   *o++ = 0;}
\DoxyCodeLine{1355   stbiw\_\_wpcrc(\&o, 13);}
\DoxyCodeLine{1356 }
\DoxyCodeLine{1357   stbiw\_\_wp32(o, zlen);}
\DoxyCodeLine{1358   stbiw\_\_wptag(o, \textcolor{stringliteral}{"{}IDAT"{}});}
\DoxyCodeLine{1359   STBIW\_MEMMOVE(o, zlib, zlen);}
\DoxyCodeLine{1360   o += zlen;}
\DoxyCodeLine{1361   STBIW\_FREE(zlib);}
\DoxyCodeLine{1362   stbiw\_\_wpcrc(\&o, zlen);}
\DoxyCodeLine{1363 }
\DoxyCodeLine{1364   stbiw\_\_wp32(o, 0);}
\DoxyCodeLine{1365   stbiw\_\_wptag(o, \textcolor{stringliteral}{"{}IEND"{}});}
\DoxyCodeLine{1366   stbiw\_\_wpcrc(\&o, 0);}
\DoxyCodeLine{1367 }
\DoxyCodeLine{1368   STBIW\_ASSERT(o == out + *out\_len);}
\DoxyCodeLine{1369 }
\DoxyCodeLine{1370   \textcolor{keywordflow}{return} out;}
\DoxyCodeLine{1371 \}}
\DoxyCodeLine{1372 }
\DoxyCodeLine{1373 \textcolor{preprocessor}{\#ifndef STBI\_WRITE\_NO\_STDIO}}
\DoxyCodeLine{1374 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_png(\textcolor{keywordtype}{char} \textcolor{keyword}{const} *filename, \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp,}
\DoxyCodeLine{1375                             \textcolor{keyword}{const} \textcolor{keywordtype}{void} *data, \textcolor{keywordtype}{int} stride\_bytes) \{}
\DoxyCodeLine{1376   FILE *f;}
\DoxyCodeLine{1377   \textcolor{keywordtype}{int} len;}
\DoxyCodeLine{1378   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *png = stbi\_write\_png\_to\_mem((\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *)data,}
\DoxyCodeLine{1379                                              stride\_bytes, x, y, comp, \&len);}
\DoxyCodeLine{1380   \textcolor{keywordflow}{if} (png == NULL)}
\DoxyCodeLine{1381     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{1382 }
\DoxyCodeLine{1383   f = stbiw\_\_fopen(filename, \textcolor{stringliteral}{"{}wb"{}});}
\DoxyCodeLine{1384   \textcolor{keywordflow}{if} (!f) \{}
\DoxyCodeLine{1385     STBIW\_FREE(png);}
\DoxyCodeLine{1386     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{1387   \}}
\DoxyCodeLine{1388   fwrite(png, 1, len, f);}
\DoxyCodeLine{1389   fclose(f);}
\DoxyCodeLine{1390   STBIW\_FREE(png);}
\DoxyCodeLine{1391   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{1392 \}}
\DoxyCodeLine{1393 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1394 }
\DoxyCodeLine{1395 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_png\_to\_func(stbi\_write\_func *func, \textcolor{keywordtype}{void} *context, \textcolor{keywordtype}{int} x,}
\DoxyCodeLine{1396                                     \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp, \textcolor{keyword}{const} \textcolor{keywordtype}{void} *data,}
\DoxyCodeLine{1397                                     \textcolor{keywordtype}{int} stride\_bytes) \{}
\DoxyCodeLine{1398   \textcolor{keywordtype}{int} len;}
\DoxyCodeLine{1399   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *png = stbi\_write\_png\_to\_mem((\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *)data,}
\DoxyCodeLine{1400                                              stride\_bytes, x, y, comp, \&len);}
\DoxyCodeLine{1401   \textcolor{keywordflow}{if} (png == NULL)}
\DoxyCodeLine{1402     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{1403   func(context, png, len);}
\DoxyCodeLine{1404   STBIW\_FREE(png);}
\DoxyCodeLine{1405   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{1406 \}}
\DoxyCodeLine{1407 }
\DoxyCodeLine{1408 \textcolor{comment}{/* ***************************************************************************}}
\DoxyCodeLine{1409 \textcolor{comment}{ *}}
\DoxyCodeLine{1410 \textcolor{comment}{ * JPEG writer}}
\DoxyCodeLine{1411 \textcolor{comment}{ *}}
\DoxyCodeLine{1412 \textcolor{comment}{ * This is based on Jon Olick's jo\_jpeg.cpp:}}
\DoxyCodeLine{1413 \textcolor{comment}{ * public domain Simple, Minimalistic JPEG writer -\/}}
\DoxyCodeLine{1414 \textcolor{comment}{ * http://www.jonolick.com/code.html}}
\DoxyCodeLine{1415 \textcolor{comment}{ */}}
\DoxyCodeLine{1416 }
\DoxyCodeLine{1417 \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} stbiw\_\_jpg\_ZigZag[] = \{}
\DoxyCodeLine{1418     0,  1,  5,  6,  14, 15, 27, 28, 2,  4,  7,  13, 16, 26, 29, 42,}
\DoxyCodeLine{1419     3,  8,  12, 17, 25, 30, 41, 43, 9,  11, 18, 24, 31, 40, 44, 53,}
\DoxyCodeLine{1420     10, 19, 23, 32, 39, 45, 52, 54, 20, 22, 33, 38, 46, 51, 55, 60,}
\DoxyCodeLine{1421     21, 34, 37, 47, 50, 56, 59, 61, 35, 36, 48, 49, 57, 58, 62, 63\};}
\DoxyCodeLine{1422 }
\DoxyCodeLine{1423 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbiw\_\_jpg\_writeBits(stbi\_\_write\_context *s, \textcolor{keywordtype}{int} *bitBufP,}
\DoxyCodeLine{1424                                  \textcolor{keywordtype}{int} *bitCntP, \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} *bs) \{}
\DoxyCodeLine{1425   \textcolor{keywordtype}{int} bitBuf = *bitBufP, bitCnt = *bitCntP;}
\DoxyCodeLine{1426   bitCnt += bs[1];}
\DoxyCodeLine{1427   bitBuf |= bs[0] << (24 -\/ bitCnt);}
\DoxyCodeLine{1428   \textcolor{keywordflow}{while} (bitCnt >= 8) \{}
\DoxyCodeLine{1429     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} c = (bitBuf >> 16) \& 255;}
\DoxyCodeLine{1430     stbiw\_\_putc(s, c);}
\DoxyCodeLine{1431     \textcolor{keywordflow}{if} (c == 255) \{}
\DoxyCodeLine{1432       stbiw\_\_putc(s, 0);}
\DoxyCodeLine{1433     \}}
\DoxyCodeLine{1434     bitBuf <<= 8;}
\DoxyCodeLine{1435     bitCnt -\/= 8;}
\DoxyCodeLine{1436   \}}
\DoxyCodeLine{1437   *bitBufP = bitBuf;}
\DoxyCodeLine{1438   *bitCntP = bitCnt;}
\DoxyCodeLine{1439 \}}
\DoxyCodeLine{1440 }
\DoxyCodeLine{1441 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbiw\_\_jpg\_DCT(\textcolor{keywordtype}{float} *d0p, \textcolor{keywordtype}{float} *d1p, \textcolor{keywordtype}{float} *d2p, \textcolor{keywordtype}{float} *d3p,}
\DoxyCodeLine{1442                            \textcolor{keywordtype}{float} *d4p, \textcolor{keywordtype}{float} *d5p, \textcolor{keywordtype}{float} *d6p, \textcolor{keywordtype}{float} *d7p) \{}
\DoxyCodeLine{1443   \textcolor{keywordtype}{float} d0 = *d0p, d1 = *d1p, d2 = *d2p, d3 = *d3p, d4 = *d4p, d5 = *d5p,}
\DoxyCodeLine{1444         d6 = *d6p, d7 = *d7p;}
\DoxyCodeLine{1445   \textcolor{keywordtype}{float} z1, z2, z3, z4, z5, z11, z13;}
\DoxyCodeLine{1446 }
\DoxyCodeLine{1447   \textcolor{keywordtype}{float} tmp0 = d0 + d7;}
\DoxyCodeLine{1448   \textcolor{keywordtype}{float} tmp7 = d0 -\/ d7;}
\DoxyCodeLine{1449   \textcolor{keywordtype}{float} tmp1 = d1 + d6;}
\DoxyCodeLine{1450   \textcolor{keywordtype}{float} tmp6 = d1 -\/ d6;}
\DoxyCodeLine{1451   \textcolor{keywordtype}{float} tmp2 = d2 + d5;}
\DoxyCodeLine{1452   \textcolor{keywordtype}{float} tmp5 = d2 -\/ d5;}
\DoxyCodeLine{1453   \textcolor{keywordtype}{float} tmp3 = d3 + d4;}
\DoxyCodeLine{1454   \textcolor{keywordtype}{float} tmp4 = d3 -\/ d4;}
\DoxyCodeLine{1455 }
\DoxyCodeLine{1456   \textcolor{comment}{// Even part}}
\DoxyCodeLine{1457   \textcolor{keywordtype}{float} tmp10 = tmp0 + tmp3; \textcolor{comment}{// phase 2}}
\DoxyCodeLine{1458   \textcolor{keywordtype}{float} tmp13 = tmp0 -\/ tmp3;}
\DoxyCodeLine{1459   \textcolor{keywordtype}{float} tmp11 = tmp1 + tmp2;}
\DoxyCodeLine{1460   \textcolor{keywordtype}{float} tmp12 = tmp1 -\/ tmp2;}
\DoxyCodeLine{1461 }
\DoxyCodeLine{1462   d0 = tmp10 + tmp11; \textcolor{comment}{// phase 3}}
\DoxyCodeLine{1463   d4 = tmp10 -\/ tmp11;}
\DoxyCodeLine{1464 }
\DoxyCodeLine{1465   z1 = (tmp12 + tmp13) * 0.707106781f; \textcolor{comment}{// c4}}
\DoxyCodeLine{1466   d2 = tmp13 + z1;                     \textcolor{comment}{// phase 5}}
\DoxyCodeLine{1467   d6 = tmp13 -\/ z1;}
\DoxyCodeLine{1468 }
\DoxyCodeLine{1469   \textcolor{comment}{// Odd part}}
\DoxyCodeLine{1470   tmp10 = tmp4 + tmp5; \textcolor{comment}{// phase 2}}
\DoxyCodeLine{1471   tmp11 = tmp5 + tmp6;}
\DoxyCodeLine{1472   tmp12 = tmp6 + tmp7;}
\DoxyCodeLine{1473 }
\DoxyCodeLine{1474   \textcolor{comment}{// The rotator is modified from fig 4-\/8 to avoid extra negations.}}
\DoxyCodeLine{1475   z5 = (tmp10 -\/ tmp12) * 0.382683433f; \textcolor{comment}{// c6}}
\DoxyCodeLine{1476   z2 = tmp10 * 0.541196100f + z5;      \textcolor{comment}{// c2-\/c6}}
\DoxyCodeLine{1477   z4 = tmp12 * 1.306562965f + z5;      \textcolor{comment}{// c2+c6}}
\DoxyCodeLine{1478   z3 = tmp11 * 0.707106781f;           \textcolor{comment}{// c4}}
\DoxyCodeLine{1479 }
\DoxyCodeLine{1480   z11 = tmp7 + z3; \textcolor{comment}{// phase 5}}
\DoxyCodeLine{1481   z13 = tmp7 -\/ z3;}
\DoxyCodeLine{1482 }
\DoxyCodeLine{1483   *d5p = z13 + z2; \textcolor{comment}{// phase 6}}
\DoxyCodeLine{1484   *d3p = z13 -\/ z2;}
\DoxyCodeLine{1485   *d1p = z11 + z4;}
\DoxyCodeLine{1486   *d7p = z11 -\/ z4;}
\DoxyCodeLine{1487 }
\DoxyCodeLine{1488   *d0p = d0;}
\DoxyCodeLine{1489   *d2p = d2;}
\DoxyCodeLine{1490   *d4p = d4;}
\DoxyCodeLine{1491   *d6p = d6;}
\DoxyCodeLine{1492 \}}
\DoxyCodeLine{1493 }
\DoxyCodeLine{1494 \textcolor{keyword}{static} \textcolor{keywordtype}{void} stbiw\_\_jpg\_calcBits(\textcolor{keywordtype}{int} val, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} bits[2]) \{}
\DoxyCodeLine{1495   \textcolor{keywordtype}{int} tmp1 = val < 0 ? -\/val : val;}
\DoxyCodeLine{1496   val = val < 0 ? val -\/ 1 : val;}
\DoxyCodeLine{1497   bits[1] = 1;}
\DoxyCodeLine{1498   \textcolor{keywordflow}{while} (tmp1 >>= 1) \{}
\DoxyCodeLine{1499     ++bits[1];}
\DoxyCodeLine{1500   \}}
\DoxyCodeLine{1501   bits[0] = val \& ((1 << bits[1]) -\/ 1);}
\DoxyCodeLine{1502 \}}
\DoxyCodeLine{1503 }
\DoxyCodeLine{1504 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbiw\_\_jpg\_processDU(stbi\_\_write\_context *s, \textcolor{keywordtype}{int} *bitBuf,}
\DoxyCodeLine{1505                                 \textcolor{keywordtype}{int} *bitCnt, \textcolor{keywordtype}{float} *CDU, \textcolor{keywordtype}{int} du\_stride,}
\DoxyCodeLine{1506                                 \textcolor{keywordtype}{float} *fdtbl, \textcolor{keywordtype}{int} DC,}
\DoxyCodeLine{1507                                 \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} HTDC[256][2],}
\DoxyCodeLine{1508                                 \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} HTAC[256][2]) \{}
\DoxyCodeLine{1509   \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} EOB[2] = \{HTAC[0x00][0], HTAC[0x00][1]\};}
\DoxyCodeLine{1510   \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} M16zeroes[2] = \{HTAC[0xF0][0], HTAC[0xF0][1]\};}
\DoxyCodeLine{1511   \textcolor{keywordtype}{int} dataOff, i, j, n, diff, end0pos, x, y;}
\DoxyCodeLine{1512   \textcolor{keywordtype}{int} DU[64];}
\DoxyCodeLine{1513 }
\DoxyCodeLine{1514   \textcolor{comment}{// DCT rows}}
\DoxyCodeLine{1515   \textcolor{keywordflow}{for} (dataOff = 0, n = du\_stride * 8; dataOff < n; dataOff += du\_stride) \{}
\DoxyCodeLine{1516     stbiw\_\_jpg\_DCT(\&CDU[dataOff], \&CDU[dataOff + 1], \&CDU[dataOff + 2],}
\DoxyCodeLine{1517                    \&CDU[dataOff + 3], \&CDU[dataOff + 4], \&CDU[dataOff + 5],}
\DoxyCodeLine{1518                    \&CDU[dataOff + 6], \&CDU[dataOff + 7]);}
\DoxyCodeLine{1519   \}}
\DoxyCodeLine{1520   \textcolor{comment}{// DCT columns}}
\DoxyCodeLine{1521   \textcolor{keywordflow}{for} (dataOff = 0; dataOff < 8; ++dataOff) \{}
\DoxyCodeLine{1522     stbiw\_\_jpg\_DCT(\&CDU[dataOff], \&CDU[dataOff + du\_stride],}
\DoxyCodeLine{1523                    \&CDU[dataOff + du\_stride * 2], \&CDU[dataOff + du\_stride * 3],}
\DoxyCodeLine{1524                    \&CDU[dataOff + du\_stride * 4], \&CDU[dataOff + du\_stride * 5],}
\DoxyCodeLine{1525                    \&CDU[dataOff + du\_stride * 6],}
\DoxyCodeLine{1526                    \&CDU[dataOff + du\_stride * 7]);}
\DoxyCodeLine{1527   \}}
\DoxyCodeLine{1528   \textcolor{comment}{// Quantize/descale/zigzag the coefficients}}
\DoxyCodeLine{1529   \textcolor{keywordflow}{for} (y = 0, j = 0; y < 8; ++y) \{}
\DoxyCodeLine{1530     \textcolor{keywordflow}{for} (x = 0; x < 8; ++x, ++j) \{}
\DoxyCodeLine{1531       \textcolor{keywordtype}{float} v;}
\DoxyCodeLine{1532       i = y * du\_stride + x;}
\DoxyCodeLine{1533       v = CDU[i] * fdtbl[j];}
\DoxyCodeLine{1534       \textcolor{comment}{// DU[stbiw\_\_jpg\_ZigZag[j]] = (int)(v < 0 ? ceilf(v -\/ 0.5f) : floorf(v +}}
\DoxyCodeLine{1535       \textcolor{comment}{// 0.5f)); ceilf() and floorf() are C99, not C89, but I /think/ they're}}
\DoxyCodeLine{1536       \textcolor{comment}{// not needed here anyway?}}
\DoxyCodeLine{1537       DU[stbiw\_\_jpg\_ZigZag[j]] = (int)(v < 0 ? v -\/ 0.5f : v + 0.5f);}
\DoxyCodeLine{1538     \}}
\DoxyCodeLine{1539   \}}
\DoxyCodeLine{1540 }
\DoxyCodeLine{1541   \textcolor{comment}{// Encode DC}}
\DoxyCodeLine{1542   diff = DU[0] -\/ DC;}
\DoxyCodeLine{1543   \textcolor{keywordflow}{if} (diff == 0) \{}
\DoxyCodeLine{1544     stbiw\_\_jpg\_writeBits(s, bitBuf, bitCnt, HTDC[0]);}
\DoxyCodeLine{1545   \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{1546     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} bits[2];}
\DoxyCodeLine{1547     stbiw\_\_jpg\_calcBits(diff, bits);}
\DoxyCodeLine{1548     stbiw\_\_jpg\_writeBits(s, bitBuf, bitCnt, HTDC[bits[1]]);}
\DoxyCodeLine{1549     stbiw\_\_jpg\_writeBits(s, bitBuf, bitCnt, bits);}
\DoxyCodeLine{1550   \}}
\DoxyCodeLine{1551   \textcolor{comment}{// Encode ACs}}
\DoxyCodeLine{1552   end0pos = 63;}
\DoxyCodeLine{1553   \textcolor{keywordflow}{for} (; (end0pos > 0) \&\& (DU[end0pos] == 0); -\/-\/end0pos) \{}
\DoxyCodeLine{1554   \}}
\DoxyCodeLine{1555   \textcolor{comment}{// end0pos = first element in reverse order !=0}}
\DoxyCodeLine{1556   \textcolor{keywordflow}{if} (end0pos == 0) \{}
\DoxyCodeLine{1557     stbiw\_\_jpg\_writeBits(s, bitBuf, bitCnt, EOB);}
\DoxyCodeLine{1558     \textcolor{keywordflow}{return} DU[0];}
\DoxyCodeLine{1559   \}}
\DoxyCodeLine{1560   \textcolor{keywordflow}{for} (i = 1; i <= end0pos; ++i) \{}
\DoxyCodeLine{1561     \textcolor{keywordtype}{int} startpos = i;}
\DoxyCodeLine{1562     \textcolor{keywordtype}{int} nrzeroes;}
\DoxyCodeLine{1563     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} bits[2];}
\DoxyCodeLine{1564     \textcolor{keywordflow}{for} (; DU[i] == 0 \&\& i <= end0pos; ++i) \{}
\DoxyCodeLine{1565     \}}
\DoxyCodeLine{1566     nrzeroes = i -\/ startpos;}
\DoxyCodeLine{1567     \textcolor{keywordflow}{if} (nrzeroes >= 16) \{}
\DoxyCodeLine{1568       \textcolor{keywordtype}{int} lng = nrzeroes >> 4;}
\DoxyCodeLine{1569       \textcolor{keywordtype}{int} nrmarker;}
\DoxyCodeLine{1570       \textcolor{keywordflow}{for} (nrmarker = 1; nrmarker <= lng; ++nrmarker)}
\DoxyCodeLine{1571         stbiw\_\_jpg\_writeBits(s, bitBuf, bitCnt, M16zeroes);}
\DoxyCodeLine{1572       nrzeroes \&= 15;}
\DoxyCodeLine{1573     \}}
\DoxyCodeLine{1574     stbiw\_\_jpg\_calcBits(DU[i], bits);}
\DoxyCodeLine{1575     stbiw\_\_jpg\_writeBits(s, bitBuf, bitCnt, HTAC[(nrzeroes << 4) + bits[1]]);}
\DoxyCodeLine{1576     stbiw\_\_jpg\_writeBits(s, bitBuf, bitCnt, bits);}
\DoxyCodeLine{1577   \}}
\DoxyCodeLine{1578   \textcolor{keywordflow}{if} (end0pos != 63) \{}
\DoxyCodeLine{1579     stbiw\_\_jpg\_writeBits(s, bitBuf, bitCnt, EOB);}
\DoxyCodeLine{1580   \}}
\DoxyCodeLine{1581   \textcolor{keywordflow}{return} DU[0];}
\DoxyCodeLine{1582 \}}
\DoxyCodeLine{1583 }
\DoxyCodeLine{1584 \textcolor{keyword}{static} \textcolor{keywordtype}{int} stbi\_write\_jpg\_core(stbi\_\_write\_context *s, \textcolor{keywordtype}{int} width, \textcolor{keywordtype}{int} height,}
\DoxyCodeLine{1585                                \textcolor{keywordtype}{int} comp, \textcolor{keyword}{const} \textcolor{keywordtype}{void} *data, \textcolor{keywordtype}{int} quality) \{}
\DoxyCodeLine{1586   \textcolor{comment}{// Constants that don't pollute global namespace}}
\DoxyCodeLine{1587   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} std\_dc\_luminance\_nrcodes[] = \{}
\DoxyCodeLine{1588       0, 0, 1, 5, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0\};}
\DoxyCodeLine{1589   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} std\_dc\_luminance\_values[] = \{0, 1, 2, 3, 4,  5,}
\DoxyCodeLine{1590                                                           6, 7, 8, 9, 10, 11\};}
\DoxyCodeLine{1591   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} std\_ac\_luminance\_nrcodes[] = \{}
\DoxyCodeLine{1592       0, 0, 2, 1, 3, 3, 2, 4, 3, 5, 5, 4, 4, 0, 0, 1, 0x7d\};}
\DoxyCodeLine{1593   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} std\_ac\_luminance\_values[] = \{}
\DoxyCodeLine{1594       0x01, 0x02, 0x03, 0x00, 0x04, 0x11, 0x05, 0x12, 0x21, 0x31, 0x41, 0x06,}
\DoxyCodeLine{1595       0x13, 0x51, 0x61, 0x07, 0x22, 0x71, 0x14, 0x32, 0x81, 0x91, 0xa1, 0x08,}
\DoxyCodeLine{1596       0x23, 0x42, 0xb1, 0xc1, 0x15, 0x52, 0xd1, 0xf0, 0x24, 0x33, 0x62, 0x72,}
\DoxyCodeLine{1597       0x82, 0x09, 0x0a, 0x16, 0x17, 0x18, 0x19, 0x1a, 0x25, 0x26, 0x27, 0x28,}
\DoxyCodeLine{1598       0x29, 0x2a, 0x34, 0x35, 0x36, 0x37, 0x38, 0x39, 0x3a, 0x43, 0x44, 0x45,}
\DoxyCodeLine{1599       0x46, 0x47, 0x48, 0x49, 0x4a, 0x53, 0x54, 0x55, 0x56, 0x57, 0x58, 0x59,}
\DoxyCodeLine{1600       0x5a, 0x63, 0x64, 0x65, 0x66, 0x67, 0x68, 0x69, 0x6a, 0x73, 0x74, 0x75,}
\DoxyCodeLine{1601       0x76, 0x77, 0x78, 0x79, 0x7a, 0x83, 0x84, 0x85, 0x86, 0x87, 0x88, 0x89,}
\DoxyCodeLine{1602       0x8a, 0x92, 0x93, 0x94, 0x95, 0x96, 0x97, 0x98, 0x99, 0x9a, 0xa2, 0xa3,}
\DoxyCodeLine{1603       0xa4, 0xa5, 0xa6, 0xa7, 0xa8, 0xa9, 0xaa, 0xb2, 0xb3, 0xb4, 0xb5, 0xb6,}
\DoxyCodeLine{1604       0xb7, 0xb8, 0xb9, 0xba, 0xc2, 0xc3, 0xc4, 0xc5, 0xc6, 0xc7, 0xc8, 0xc9,}
\DoxyCodeLine{1605       0xca, 0xd2, 0xd3, 0xd4, 0xd5, 0xd6, 0xd7, 0xd8, 0xd9, 0xda, 0xe1, 0xe2,}
\DoxyCodeLine{1606       0xe3, 0xe4, 0xe5, 0xe6, 0xe7, 0xe8, 0xe9, 0xea, 0xf1, 0xf2, 0xf3, 0xf4,}
\DoxyCodeLine{1607       0xf5, 0xf6, 0xf7, 0xf8, 0xf9, 0xfa\};}
\DoxyCodeLine{1608   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} std\_dc\_chrominance\_nrcodes[] = \{}
\DoxyCodeLine{1609       0, 0, 3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0\};}
\DoxyCodeLine{1610   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} std\_dc\_chrominance\_values[] = \{0, 1, 2, 3, 4,  5,}
\DoxyCodeLine{1611                                                             6, 7, 8, 9, 10, 11\};}
\DoxyCodeLine{1612   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} std\_ac\_chrominance\_nrcodes[] = \{}
\DoxyCodeLine{1613       0, 0, 2, 1, 2, 4, 4, 3, 4, 7, 5, 4, 4, 0, 1, 2, 0x77\};}
\DoxyCodeLine{1614   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} std\_ac\_chrominance\_values[] = \{}
\DoxyCodeLine{1615       0x00, 0x01, 0x02, 0x03, 0x11, 0x04, 0x05, 0x21, 0x31, 0x06, 0x12, 0x41,}
\DoxyCodeLine{1616       0x51, 0x07, 0x61, 0x71, 0x13, 0x22, 0x32, 0x81, 0x08, 0x14, 0x42, 0x91,}
\DoxyCodeLine{1617       0xa1, 0xb1, 0xc1, 0x09, 0x23, 0x33, 0x52, 0xf0, 0x15, 0x62, 0x72, 0xd1,}
\DoxyCodeLine{1618       0x0a, 0x16, 0x24, 0x34, 0xe1, 0x25, 0xf1, 0x17, 0x18, 0x19, 0x1a, 0x26,}
\DoxyCodeLine{1619       0x27, 0x28, 0x29, 0x2a, 0x35, 0x36, 0x37, 0x38, 0x39, 0x3a, 0x43, 0x44,}
\DoxyCodeLine{1620       0x45, 0x46, 0x47, 0x48, 0x49, 0x4a, 0x53, 0x54, 0x55, 0x56, 0x57, 0x58,}
\DoxyCodeLine{1621       0x59, 0x5a, 0x63, 0x64, 0x65, 0x66, 0x67, 0x68, 0x69, 0x6a, 0x73, 0x74,}
\DoxyCodeLine{1622       0x75, 0x76, 0x77, 0x78, 0x79, 0x7a, 0x82, 0x83, 0x84, 0x85, 0x86, 0x87,}
\DoxyCodeLine{1623       0x88, 0x89, 0x8a, 0x92, 0x93, 0x94, 0x95, 0x96, 0x97, 0x98, 0x99, 0x9a,}
\DoxyCodeLine{1624       0xa2, 0xa3, 0xa4, 0xa5, 0xa6, 0xa7, 0xa8, 0xa9, 0xaa, 0xb2, 0xb3, 0xb4,}
\DoxyCodeLine{1625       0xb5, 0xb6, 0xb7, 0xb8, 0xb9, 0xba, 0xc2, 0xc3, 0xc4, 0xc5, 0xc6, 0xc7,}
\DoxyCodeLine{1626       0xc8, 0xc9, 0xca, 0xd2, 0xd3, 0xd4, 0xd5, 0xd6, 0xd7, 0xd8, 0xd9, 0xda,}
\DoxyCodeLine{1627       0xe2, 0xe3, 0xe4, 0xe5, 0xe6, 0xe7, 0xe8, 0xe9, 0xea, 0xf2, 0xf3, 0xf4,}
\DoxyCodeLine{1628       0xf5, 0xf6, 0xf7, 0xf8, 0xf9, 0xfa\};}
\DoxyCodeLine{1629   \textcolor{comment}{// Huffman tables}}
\DoxyCodeLine{1630   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} YDC\_HT[256][2] = \{}
\DoxyCodeLine{1631       \{0, 2\},  \{2, 3\},  \{3, 3\},  \{4, 3\},   \{5, 3\},   \{6, 3\},}
\DoxyCodeLine{1632       \{14, 4\}, \{30, 5\}, \{62, 6\}, \{126, 7\}, \{254, 8\}, \{510, 9\}\};}
\DoxyCodeLine{1633   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} UVDC\_HT[256][2] = \{}
\DoxyCodeLine{1634       \{0, 2\},  \{1, 2\},   \{2, 2\},   \{6, 3\},   \{14, 4\},    \{30, 5\},}
\DoxyCodeLine{1635       \{62, 6\}, \{126, 7\}, \{254, 8\}, \{510, 9\}, \{1022, 10\}, \{2046, 11\}\};}
\DoxyCodeLine{1636   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} YAC\_HT[256][2] = \{}
\DoxyCodeLine{1637       \{10, 4\},     \{0, 2\},      \{1, 2\},      \{4, 3\},      \{11, 4\},}
\DoxyCodeLine{1638       \{26, 5\},     \{120, 7\},    \{248, 8\},    \{1014, 10\},  \{65410, 16\},}
\DoxyCodeLine{1639       \{65411, 16\}, \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},}
\DoxyCodeLine{1640       \{0, 0\},      \{0, 0\},      \{12, 4\},     \{27, 5\},     \{121, 7\},}
\DoxyCodeLine{1641       \{502, 9\},    \{2038, 11\},  \{65412, 16\}, \{65413, 16\}, \{65414, 16\},}
\DoxyCodeLine{1642       \{65415, 16\}, \{65416, 16\}, \{0, 0\},      \{0, 0\},      \{0, 0\},}
\DoxyCodeLine{1643       \{0, 0\},      \{0, 0\},      \{0, 0\},      \{28, 5\},     \{249, 8\},}
\DoxyCodeLine{1644       \{1015, 10\},  \{4084, 12\},  \{65417, 16\}, \{65418, 16\}, \{65419, 16\},}
\DoxyCodeLine{1645       \{65420, 16\}, \{65421, 16\}, \{65422, 16\}, \{0, 0\},      \{0, 0\},}
\DoxyCodeLine{1646       \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},      \{58, 6\},}
\DoxyCodeLine{1647       \{503, 9\},    \{4085, 12\},  \{65423, 16\}, \{65424, 16\}, \{65425, 16\},}
\DoxyCodeLine{1648       \{65426, 16\}, \{65427, 16\}, \{65428, 16\}, \{65429, 16\}, \{0, 0\},}
\DoxyCodeLine{1649       \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},}
\DoxyCodeLine{1650       \{59, 6\},     \{1016, 10\},  \{65430, 16\}, \{65431, 16\}, \{65432, 16\},}
\DoxyCodeLine{1651       \{65433, 16\}, \{65434, 16\}, \{65435, 16\}, \{65436, 16\}, \{65437, 16\},}
\DoxyCodeLine{1652       \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},}
\DoxyCodeLine{1653       \{0, 0\},      \{122, 7\},    \{2039, 11\},  \{65438, 16\}, \{65439, 16\},}
\DoxyCodeLine{1654       \{65440, 16\}, \{65441, 16\}, \{65442, 16\}, \{65443, 16\}, \{65444, 16\},}
\DoxyCodeLine{1655       \{65445, 16\}, \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},}
\DoxyCodeLine{1656       \{0, 0\},      \{0, 0\},      \{123, 7\},    \{4086, 12\},  \{65446, 16\},}
\DoxyCodeLine{1657       \{65447, 16\}, \{65448, 16\}, \{65449, 16\}, \{65450, 16\}, \{65451, 16\},}
\DoxyCodeLine{1658       \{65452, 16\}, \{65453, 16\}, \{0, 0\},      \{0, 0\},      \{0, 0\},}
\DoxyCodeLine{1659       \{0, 0\},      \{0, 0\},      \{0, 0\},      \{250, 8\},    \{4087, 12\},}
\DoxyCodeLine{1660       \{65454, 16\}, \{65455, 16\}, \{65456, 16\}, \{65457, 16\}, \{65458, 16\},}
\DoxyCodeLine{1661       \{65459, 16\}, \{65460, 16\}, \{65461, 16\}, \{0, 0\},      \{0, 0\},}
\DoxyCodeLine{1662       \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},      \{504, 9\},}
\DoxyCodeLine{1663       \{32704, 15\}, \{65462, 16\}, \{65463, 16\}, \{65464, 16\}, \{65465, 16\},}
\DoxyCodeLine{1664       \{65466, 16\}, \{65467, 16\}, \{65468, 16\}, \{65469, 16\}, \{0, 0\},}
\DoxyCodeLine{1665       \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},}
\DoxyCodeLine{1666       \{505, 9\},    \{65470, 16\}, \{65471, 16\}, \{65472, 16\}, \{65473, 16\},}
\DoxyCodeLine{1667       \{65474, 16\}, \{65475, 16\}, \{65476, 16\}, \{65477, 16\}, \{65478, 16\},}
\DoxyCodeLine{1668       \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},}
\DoxyCodeLine{1669       \{0, 0\},      \{506, 9\},    \{65479, 16\}, \{65480, 16\}, \{65481, 16\},}
\DoxyCodeLine{1670       \{65482, 16\}, \{65483, 16\}, \{65484, 16\}, \{65485, 16\}, \{65486, 16\},}
\DoxyCodeLine{1671       \{65487, 16\}, \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},}
\DoxyCodeLine{1672       \{0, 0\},      \{0, 0\},      \{1017, 10\},  \{65488, 16\}, \{65489, 16\},}
\DoxyCodeLine{1673       \{65490, 16\}, \{65491, 16\}, \{65492, 16\}, \{65493, 16\}, \{65494, 16\},}
\DoxyCodeLine{1674       \{65495, 16\}, \{65496, 16\}, \{0, 0\},      \{0, 0\},      \{0, 0\},}
\DoxyCodeLine{1675       \{0, 0\},      \{0, 0\},      \{0, 0\},      \{1018, 10\},  \{65497, 16\},}
\DoxyCodeLine{1676       \{65498, 16\}, \{65499, 16\}, \{65500, 16\}, \{65501, 16\}, \{65502, 16\},}
\DoxyCodeLine{1677       \{65503, 16\}, \{65504, 16\}, \{65505, 16\}, \{0, 0\},      \{0, 0\},}
\DoxyCodeLine{1678       \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},      \{2040, 11\},}
\DoxyCodeLine{1679       \{65506, 16\}, \{65507, 16\}, \{65508, 16\}, \{65509, 16\}, \{65510, 16\},}
\DoxyCodeLine{1680       \{65511, 16\}, \{65512, 16\}, \{65513, 16\}, \{65514, 16\}, \{0, 0\},}
\DoxyCodeLine{1681       \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},}
\DoxyCodeLine{1682       \{65515, 16\}, \{65516, 16\}, \{65517, 16\}, \{65518, 16\}, \{65519, 16\},}
\DoxyCodeLine{1683       \{65520, 16\}, \{65521, 16\}, \{65522, 16\}, \{65523, 16\}, \{65524, 16\},}
\DoxyCodeLine{1684       \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},}
\DoxyCodeLine{1685       \{2041, 11\},  \{65525, 16\}, \{65526, 16\}, \{65527, 16\}, \{65528, 16\},}
\DoxyCodeLine{1686       \{65529, 16\}, \{65530, 16\}, \{65531, 16\}, \{65532, 16\}, \{65533, 16\},}
\DoxyCodeLine{1687       \{65534, 16\}, \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},}
\DoxyCodeLine{1688       \{0, 0\}\};}
\DoxyCodeLine{1689   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} UVAC\_HT[256][2] = \{}
\DoxyCodeLine{1690       \{0, 2\},      \{1, 2\},      \{4, 3\},      \{10, 4\},     \{24, 5\},}
\DoxyCodeLine{1691       \{25, 5\},     \{56, 6\},     \{120, 7\},    \{500, 9\},    \{1014, 10\},}
\DoxyCodeLine{1692       \{4084, 12\},  \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},}
\DoxyCodeLine{1693       \{0, 0\},      \{0, 0\},      \{11, 4\},     \{57, 6\},     \{246, 8\},}
\DoxyCodeLine{1694       \{501, 9\},    \{2038, 11\},  \{4085, 12\},  \{65416, 16\}, \{65417, 16\},}
\DoxyCodeLine{1695       \{65418, 16\}, \{65419, 16\}, \{0, 0\},      \{0, 0\},      \{0, 0\},}
\DoxyCodeLine{1696       \{0, 0\},      \{0, 0\},      \{0, 0\},      \{26, 5\},     \{247, 8\},}
\DoxyCodeLine{1697       \{1015, 10\},  \{4086, 12\},  \{32706, 15\}, \{65420, 16\}, \{65421, 16\},}
\DoxyCodeLine{1698       \{65422, 16\}, \{65423, 16\}, \{65424, 16\}, \{0, 0\},      \{0, 0\},}
\DoxyCodeLine{1699       \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},      \{27, 5\},}
\DoxyCodeLine{1700       \{248, 8\},    \{1016, 10\},  \{4087, 12\},  \{65425, 16\}, \{65426, 16\},}
\DoxyCodeLine{1701       \{65427, 16\}, \{65428, 16\}, \{65429, 16\}, \{65430, 16\}, \{0, 0\},}
\DoxyCodeLine{1702       \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},}
\DoxyCodeLine{1703       \{58, 6\},     \{502, 9\},    \{65431, 16\}, \{65432, 16\}, \{65433, 16\},}
\DoxyCodeLine{1704       \{65434, 16\}, \{65435, 16\}, \{65436, 16\}, \{65437, 16\}, \{65438, 16\},}
\DoxyCodeLine{1705       \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},}
\DoxyCodeLine{1706       \{0, 0\},      \{59, 6\},     \{1017, 10\},  \{65439, 16\}, \{65440, 16\},}
\DoxyCodeLine{1707       \{65441, 16\}, \{65442, 16\}, \{65443, 16\}, \{65444, 16\}, \{65445, 16\},}
\DoxyCodeLine{1708       \{65446, 16\}, \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},}
\DoxyCodeLine{1709       \{0, 0\},      \{0, 0\},      \{121, 7\},    \{2039, 11\},  \{65447, 16\},}
\DoxyCodeLine{1710       \{65448, 16\}, \{65449, 16\}, \{65450, 16\}, \{65451, 16\}, \{65452, 16\},}
\DoxyCodeLine{1711       \{65453, 16\}, \{65454, 16\}, \{0, 0\},      \{0, 0\},      \{0, 0\},}
\DoxyCodeLine{1712       \{0, 0\},      \{0, 0\},      \{0, 0\},      \{122, 7\},    \{2040, 11\},}
\DoxyCodeLine{1713       \{65455, 16\}, \{65456, 16\}, \{65457, 16\}, \{65458, 16\}, \{65459, 16\},}
\DoxyCodeLine{1714       \{65460, 16\}, \{65461, 16\}, \{65462, 16\}, \{0, 0\},      \{0, 0\},}
\DoxyCodeLine{1715       \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},      \{249, 8\},}
\DoxyCodeLine{1716       \{65463, 16\}, \{65464, 16\}, \{65465, 16\}, \{65466, 16\}, \{65467, 16\},}
\DoxyCodeLine{1717       \{65468, 16\}, \{65469, 16\}, \{65470, 16\}, \{65471, 16\}, \{0, 0\},}
\DoxyCodeLine{1718       \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},}
\DoxyCodeLine{1719       \{503, 9\},    \{65472, 16\}, \{65473, 16\}, \{65474, 16\}, \{65475, 16\},}
\DoxyCodeLine{1720       \{65476, 16\}, \{65477, 16\}, \{65478, 16\}, \{65479, 16\}, \{65480, 16\},}
\DoxyCodeLine{1721       \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},}
\DoxyCodeLine{1722       \{0, 0\},      \{504, 9\},    \{65481, 16\}, \{65482, 16\}, \{65483, 16\},}
\DoxyCodeLine{1723       \{65484, 16\}, \{65485, 16\}, \{65486, 16\}, \{65487, 16\}, \{65488, 16\},}
\DoxyCodeLine{1724       \{65489, 16\}, \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},}
\DoxyCodeLine{1725       \{0, 0\},      \{0, 0\},      \{505, 9\},    \{65490, 16\}, \{65491, 16\},}
\DoxyCodeLine{1726       \{65492, 16\}, \{65493, 16\}, \{65494, 16\}, \{65495, 16\}, \{65496, 16\},}
\DoxyCodeLine{1727       \{65497, 16\}, \{65498, 16\}, \{0, 0\},      \{0, 0\},      \{0, 0\},}
\DoxyCodeLine{1728       \{0, 0\},      \{0, 0\},      \{0, 0\},      \{506, 9\},    \{65499, 16\},}
\DoxyCodeLine{1729       \{65500, 16\}, \{65501, 16\}, \{65502, 16\}, \{65503, 16\}, \{65504, 16\},}
\DoxyCodeLine{1730       \{65505, 16\}, \{65506, 16\}, \{65507, 16\}, \{0, 0\},      \{0, 0\},}
\DoxyCodeLine{1731       \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},      \{2041, 11\},}
\DoxyCodeLine{1732       \{65508, 16\}, \{65509, 16\}, \{65510, 16\}, \{65511, 16\}, \{65512, 16\},}
\DoxyCodeLine{1733       \{65513, 16\}, \{65514, 16\}, \{65515, 16\}, \{65516, 16\}, \{0, 0\},}
\DoxyCodeLine{1734       \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},}
\DoxyCodeLine{1735       \{16352, 14\}, \{65517, 16\}, \{65518, 16\}, \{65519, 16\}, \{65520, 16\},}
\DoxyCodeLine{1736       \{65521, 16\}, \{65522, 16\}, \{65523, 16\}, \{65524, 16\}, \{65525, 16\},}
\DoxyCodeLine{1737       \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},}
\DoxyCodeLine{1738       \{1018, 10\},  \{32707, 15\}, \{65526, 16\}, \{65527, 16\}, \{65528, 16\},}
\DoxyCodeLine{1739       \{65529, 16\}, \{65530, 16\}, \{65531, 16\}, \{65532, 16\}, \{65533, 16\},}
\DoxyCodeLine{1740       \{65534, 16\}, \{0, 0\},      \{0, 0\},      \{0, 0\},      \{0, 0\},}
\DoxyCodeLine{1741       \{0, 0\}\};}
\DoxyCodeLine{1742   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{int} YQT[] = \{}
\DoxyCodeLine{1743       16, 11, 10, 16, 24,  40,  51,  61,  12, 12, 14, 19, 26,  58,  60,  55,}
\DoxyCodeLine{1744       14, 13, 16, 24, 40,  57,  69,  56,  14, 17, 22, 29, 51,  87,  80,  62,}
\DoxyCodeLine{1745       18, 22, 37, 56, 68,  109, 103, 77,  24, 35, 55, 64, 81,  104, 113, 92,}
\DoxyCodeLine{1746       49, 64, 78, 87, 103, 121, 120, 101, 72, 92, 95, 98, 112, 100, 103, 99\};}
\DoxyCodeLine{1747   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{int} UVQT[] = \{17, 18, 24, 47, 99, 99, 99, 99, 18, 21, 26, 66, 99,}
\DoxyCodeLine{1748                              99, 99, 99, 24, 26, 56, 99, 99, 99, 99, 99, 47, 66,}
\DoxyCodeLine{1749                              99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99,}
\DoxyCodeLine{1750                              99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99,}
\DoxyCodeLine{1751                              99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99, 99\};}
\DoxyCodeLine{1752   \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{float} aasf[] = \{}
\DoxyCodeLine{1753       1.0f * 2.828427125f,         1.387039845f * 2.828427125f,}
\DoxyCodeLine{1754       1.306562965f * 2.828427125f, 1.175875602f * 2.828427125f,}
\DoxyCodeLine{1755       1.0f * 2.828427125f,         0.785694958f * 2.828427125f,}
\DoxyCodeLine{1756       0.541196100f * 2.828427125f, 0.275899379f * 2.828427125f\};}
\DoxyCodeLine{1757 }
\DoxyCodeLine{1758   \textcolor{keywordtype}{int} row, col, i, k, subsample;}
\DoxyCodeLine{1759   \textcolor{keywordtype}{float} fdtbl\_Y[64], fdtbl\_UV[64];}
\DoxyCodeLine{1760   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} YTable[64], UVTable[64];}
\DoxyCodeLine{1761 }
\DoxyCodeLine{1762   \textcolor{keywordflow}{if} (!data || !width || !height || comp > 4 || comp < 1) \{}
\DoxyCodeLine{1763     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{1764   \}}
\DoxyCodeLine{1765 }
\DoxyCodeLine{1766   quality = quality ? quality : 90;}
\DoxyCodeLine{1767   subsample = quality <= 90 ? 1 : 0;}
\DoxyCodeLine{1768   quality = quality < 1 ? 1 : quality > 100 ? 100 : quality;}
\DoxyCodeLine{1769   quality = quality < 50 ? 5000 / quality : 200 -\/ quality * 2;}
\DoxyCodeLine{1770 }
\DoxyCodeLine{1771   \textcolor{keywordflow}{for} (i = 0; i < 64; ++i) \{}
\DoxyCodeLine{1772     \textcolor{keywordtype}{int} uvti, yti = (YQT[i] * quality + 50) / 100;}
\DoxyCodeLine{1773     YTable[stbiw\_\_jpg\_ZigZag[i]] = (\textcolor{keywordtype}{unsigned} char)(yti < 1     ? 1}
\DoxyCodeLine{1774                                                    : yti > 255 ? 255}
\DoxyCodeLine{1775                                                                : yti);}
\DoxyCodeLine{1776     uvti = (UVQT[i] * quality + 50) / 100;}
\DoxyCodeLine{1777     UVTable[stbiw\_\_jpg\_ZigZag[i]] = (\textcolor{keywordtype}{unsigned} char)(uvti < 1     ? 1}
\DoxyCodeLine{1778                                                     : uvti > 255 ? 255}
\DoxyCodeLine{1779                                                                  : uvti);}
\DoxyCodeLine{1780   \}}
\DoxyCodeLine{1781 }
\DoxyCodeLine{1782   \textcolor{keywordflow}{for} (row = 0, k = 0; row < 8; ++row) \{}
\DoxyCodeLine{1783     \textcolor{keywordflow}{for} (col = 0; col < 8; ++col, ++k) \{}
\DoxyCodeLine{1784       fdtbl\_Y[k] = 1 / (YTable[stbiw\_\_jpg\_ZigZag[k]] * aasf[row] * aasf[col]);}
\DoxyCodeLine{1785       fdtbl\_UV[k] = 1 / (UVTable[stbiw\_\_jpg\_ZigZag[k]] * aasf[row] * aasf[col]);}
\DoxyCodeLine{1786     \}}
\DoxyCodeLine{1787   \}}
\DoxyCodeLine{1788 }
\DoxyCodeLine{1789   \textcolor{comment}{// Write Headers}}
\DoxyCodeLine{1790   \{}
\DoxyCodeLine{1791     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} head0[] = \{}
\DoxyCodeLine{1792         0xFF, 0xD8, 0xFF, 0xE0, 0, 0x10, \textcolor{charliteral}{'J'}, \textcolor{charliteral}{'F'},  \textcolor{charliteral}{'I'},  \textcolor{charliteral}{'F'}, 0,    1, 1,}
\DoxyCodeLine{1793         0,    0,    1,    0,    1, 0,    0,   0xFF, 0xDB, 0,   0x84, 0\};}
\DoxyCodeLine{1794     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} head2[] = \{0xFF, 0xDA, 0, 0xC,  3, 1,    0,}
\DoxyCodeLine{1795                                           2,    0x11, 3, 0x11, 0, 0x3F, 0\};}
\DoxyCodeLine{1796     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} head1[] = \{0xFF,}
\DoxyCodeLine{1797                                    0xC0,}
\DoxyCodeLine{1798                                    0,}
\DoxyCodeLine{1799                                    0x11,}
\DoxyCodeLine{1800                                    8,}
\DoxyCodeLine{1801                                    (\textcolor{keywordtype}{unsigned} char)(height >> 8),}
\DoxyCodeLine{1802                                    STBIW\_UCHAR(height),}
\DoxyCodeLine{1803                                    (\textcolor{keywordtype}{unsigned} char)(width >> 8),}
\DoxyCodeLine{1804                                    STBIW\_UCHAR(width),}
\DoxyCodeLine{1805                                    3,}
\DoxyCodeLine{1806                                    1,}
\DoxyCodeLine{1807                                    (\textcolor{keywordtype}{unsigned} char)(subsample ? 0x22 : 0x11),}
\DoxyCodeLine{1808                                    0,}
\DoxyCodeLine{1809                                    2,}
\DoxyCodeLine{1810                                    0x11,}
\DoxyCodeLine{1811                                    1,}
\DoxyCodeLine{1812                                    3,}
\DoxyCodeLine{1813                                    0x11,}
\DoxyCodeLine{1814                                    1,}
\DoxyCodeLine{1815                                    0xFF,}
\DoxyCodeLine{1816                                    0xC4,}
\DoxyCodeLine{1817                                    0x01,}
\DoxyCodeLine{1818                                    0xA2,}
\DoxyCodeLine{1819                                    0\};}
\DoxyCodeLine{1820     s-\/>func(s-\/>context, (\textcolor{keywordtype}{void} *)head0, \textcolor{keyword}{sizeof}(head0));}
\DoxyCodeLine{1821     s-\/>func(s-\/>context, (\textcolor{keywordtype}{void} *)YTable, \textcolor{keyword}{sizeof}(YTable));}
\DoxyCodeLine{1822     stbiw\_\_putc(s, 1);}
\DoxyCodeLine{1823     s-\/>func(s-\/>context, UVTable, \textcolor{keyword}{sizeof}(UVTable));}
\DoxyCodeLine{1824     s-\/>func(s-\/>context, (\textcolor{keywordtype}{void} *)head1, \textcolor{keyword}{sizeof}(head1));}
\DoxyCodeLine{1825     s-\/>func(s-\/>context, (\textcolor{keywordtype}{void} *)(std\_dc\_luminance\_nrcodes + 1),}
\DoxyCodeLine{1826             \textcolor{keyword}{sizeof}(std\_dc\_luminance\_nrcodes) -\/ 1);}
\DoxyCodeLine{1827     s-\/>func(s-\/>context, (\textcolor{keywordtype}{void} *)std\_dc\_luminance\_values,}
\DoxyCodeLine{1828             \textcolor{keyword}{sizeof}(std\_dc\_luminance\_values));}
\DoxyCodeLine{1829     stbiw\_\_putc(s, 0x10); \textcolor{comment}{// HTYACinfo}}
\DoxyCodeLine{1830     s-\/>func(s-\/>context, (\textcolor{keywordtype}{void} *)(std\_ac\_luminance\_nrcodes + 1),}
\DoxyCodeLine{1831             \textcolor{keyword}{sizeof}(std\_ac\_luminance\_nrcodes) -\/ 1);}
\DoxyCodeLine{1832     s-\/>func(s-\/>context, (\textcolor{keywordtype}{void} *)std\_ac\_luminance\_values,}
\DoxyCodeLine{1833             \textcolor{keyword}{sizeof}(std\_ac\_luminance\_values));}
\DoxyCodeLine{1834     stbiw\_\_putc(s, 1); \textcolor{comment}{// HTUDCinfo}}
\DoxyCodeLine{1835     s-\/>func(s-\/>context, (\textcolor{keywordtype}{void} *)(std\_dc\_chrominance\_nrcodes + 1),}
\DoxyCodeLine{1836             \textcolor{keyword}{sizeof}(std\_dc\_chrominance\_nrcodes) -\/ 1);}
\DoxyCodeLine{1837     s-\/>func(s-\/>context, (\textcolor{keywordtype}{void} *)std\_dc\_chrominance\_values,}
\DoxyCodeLine{1838             \textcolor{keyword}{sizeof}(std\_dc\_chrominance\_values));}
\DoxyCodeLine{1839     stbiw\_\_putc(s, 0x11); \textcolor{comment}{// HTUACinfo}}
\DoxyCodeLine{1840     s-\/>func(s-\/>context, (\textcolor{keywordtype}{void} *)(std\_ac\_chrominance\_nrcodes + 1),}
\DoxyCodeLine{1841             \textcolor{keyword}{sizeof}(std\_ac\_chrominance\_nrcodes) -\/ 1);}
\DoxyCodeLine{1842     s-\/>func(s-\/>context, (\textcolor{keywordtype}{void} *)std\_ac\_chrominance\_values,}
\DoxyCodeLine{1843             \textcolor{keyword}{sizeof}(std\_ac\_chrominance\_values));}
\DoxyCodeLine{1844     s-\/>func(s-\/>context, (\textcolor{keywordtype}{void} *)head2, \textcolor{keyword}{sizeof}(head2));}
\DoxyCodeLine{1845   \}}
\DoxyCodeLine{1846 }
\DoxyCodeLine{1847   \textcolor{comment}{// Encode 8x8 macroblocks}}
\DoxyCodeLine{1848   \{}
\DoxyCodeLine{1849     \textcolor{keyword}{static} \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} fillBits[] = \{0x7F, 7\};}
\DoxyCodeLine{1850     \textcolor{keywordtype}{int} DCY = 0, DCU = 0, DCV = 0;}
\DoxyCodeLine{1851     \textcolor{keywordtype}{int} bitBuf = 0, bitCnt = 0;}
\DoxyCodeLine{1852     \textcolor{comment}{// comp == 2 is grey+alpha (alpha is ignored)}}
\DoxyCodeLine{1853     \textcolor{keywordtype}{int} ofsG = comp > 2 ? 1 : 0, ofsB = comp > 2 ? 2 : 0;}
\DoxyCodeLine{1854     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *dataR = (\textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *)data;}
\DoxyCodeLine{1855     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *dataG = dataR + ofsG;}
\DoxyCodeLine{1856     \textcolor{keyword}{const} \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *dataB = dataR + ofsB;}
\DoxyCodeLine{1857     \textcolor{keywordtype}{int} x, y, pos;}
\DoxyCodeLine{1858     \textcolor{keywordflow}{if} (subsample) \{}
\DoxyCodeLine{1859       \textcolor{keywordflow}{for} (y = 0; y < height; y += 16) \{}
\DoxyCodeLine{1860         \textcolor{keywordflow}{for} (x = 0; x < width; x += 16) \{}
\DoxyCodeLine{1861           \textcolor{keywordtype}{float} Y[256], U[256], V[256];}
\DoxyCodeLine{1862           \textcolor{keywordflow}{for} (row = y, pos = 0; row < y + 16; ++row) \{}
\DoxyCodeLine{1863             \textcolor{comment}{// row >= height => use last input row}}
\DoxyCodeLine{1864             \textcolor{keywordtype}{int} clamped\_row = (row < height) ? row : height -\/ 1;}
\DoxyCodeLine{1865             \textcolor{keywordtype}{int} base\_p =}
\DoxyCodeLine{1866                 (stbi\_\_flip\_vertically\_on\_write ? (height -\/ 1 -\/ clamped\_row)}
\DoxyCodeLine{1867                                                 : clamped\_row) *}
\DoxyCodeLine{1868                 width * comp;}
\DoxyCodeLine{1869             \textcolor{keywordflow}{for} (col = x; col < x + 16; ++col, ++pos) \{}
\DoxyCodeLine{1870               \textcolor{comment}{// if col >= width => use pixel from last input column}}
\DoxyCodeLine{1871               \textcolor{keywordtype}{int} p = base\_p + ((col < width) ? col : (width -\/ 1)) * comp;}
\DoxyCodeLine{1872               \textcolor{keywordtype}{float} r = dataR[p], g = dataG[p], b = dataB[p];}
\DoxyCodeLine{1873               Y[pos] = +0.29900f * r + 0.58700f * g + 0.11400f * b -\/ 128;}
\DoxyCodeLine{1874               U[pos] = -\/0.16874f * r -\/ 0.33126f * g + 0.50000f * b;}
\DoxyCodeLine{1875               V[pos] = +0.50000f * r -\/ 0.41869f * g -\/ 0.08131f * b;}
\DoxyCodeLine{1876             \}}
\DoxyCodeLine{1877           \}}
\DoxyCodeLine{1878           DCY = stbiw\_\_jpg\_processDU(s, \&bitBuf, \&bitCnt, Y + 0, 16, fdtbl\_Y,}
\DoxyCodeLine{1879                                      DCY, YDC\_HT, YAC\_HT);}
\DoxyCodeLine{1880           DCY = stbiw\_\_jpg\_processDU(s, \&bitBuf, \&bitCnt, Y + 8, 16, fdtbl\_Y,}
\DoxyCodeLine{1881                                      DCY, YDC\_HT, YAC\_HT);}
\DoxyCodeLine{1882           DCY = stbiw\_\_jpg\_processDU(s, \&bitBuf, \&bitCnt, Y + 128, 16, fdtbl\_Y,}
\DoxyCodeLine{1883                                      DCY, YDC\_HT, YAC\_HT);}
\DoxyCodeLine{1884           DCY = stbiw\_\_jpg\_processDU(s, \&bitBuf, \&bitCnt, Y + 136, 16, fdtbl\_Y,}
\DoxyCodeLine{1885                                      DCY, YDC\_HT, YAC\_HT);}
\DoxyCodeLine{1886 }
\DoxyCodeLine{1887           \textcolor{comment}{// subsample U,V}}
\DoxyCodeLine{1888           \{}
\DoxyCodeLine{1889             \textcolor{keywordtype}{float} subU[64], subV[64];}
\DoxyCodeLine{1890             \textcolor{keywordtype}{int} yy, xx;}
\DoxyCodeLine{1891             \textcolor{keywordflow}{for} (yy = 0, pos = 0; yy < 8; ++yy) \{}
\DoxyCodeLine{1892               \textcolor{keywordflow}{for} (xx = 0; xx < 8; ++xx, ++pos) \{}
\DoxyCodeLine{1893                 \textcolor{keywordtype}{int} j = yy * 32 + xx * 2;}
\DoxyCodeLine{1894                 subU[pos] =}
\DoxyCodeLine{1895                     (U[j + 0] + U[j + 1] + U[j + 16] + U[j + 17]) * 0.25f;}
\DoxyCodeLine{1896                 subV[pos] =}
\DoxyCodeLine{1897                     (V[j + 0] + V[j + 1] + V[j + 16] + V[j + 17]) * 0.25f;}
\DoxyCodeLine{1898               \}}
\DoxyCodeLine{1899             \}}
\DoxyCodeLine{1900             DCU = stbiw\_\_jpg\_processDU(s, \&bitBuf, \&bitCnt, subU, 8, fdtbl\_UV,}
\DoxyCodeLine{1901                                        DCU, UVDC\_HT, UVAC\_HT);}
\DoxyCodeLine{1902             DCV = stbiw\_\_jpg\_processDU(s, \&bitBuf, \&bitCnt, subV, 8, fdtbl\_UV,}
\DoxyCodeLine{1903                                        DCV, UVDC\_HT, UVAC\_HT);}
\DoxyCodeLine{1904           \}}
\DoxyCodeLine{1905         \}}
\DoxyCodeLine{1906       \}}
\DoxyCodeLine{1907     \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{1908       \textcolor{keywordflow}{for} (y = 0; y < height; y += 8) \{}
\DoxyCodeLine{1909         \textcolor{keywordflow}{for} (x = 0; x < width; x += 8) \{}
\DoxyCodeLine{1910           \textcolor{keywordtype}{float} Y[64], U[64], V[64];}
\DoxyCodeLine{1911           \textcolor{keywordflow}{for} (row = y, pos = 0; row < y + 8; ++row) \{}
\DoxyCodeLine{1912             \textcolor{comment}{// row >= height => use last input row}}
\DoxyCodeLine{1913             \textcolor{keywordtype}{int} clamped\_row = (row < height) ? row : height -\/ 1;}
\DoxyCodeLine{1914             \textcolor{keywordtype}{int} base\_p =}
\DoxyCodeLine{1915                 (stbi\_\_flip\_vertically\_on\_write ? (height -\/ 1 -\/ clamped\_row)}
\DoxyCodeLine{1916                                                 : clamped\_row) *}
\DoxyCodeLine{1917                 width * comp;}
\DoxyCodeLine{1918             \textcolor{keywordflow}{for} (col = x; col < x + 8; ++col, ++pos) \{}
\DoxyCodeLine{1919               \textcolor{comment}{// if col >= width => use pixel from last input column}}
\DoxyCodeLine{1920               \textcolor{keywordtype}{int} p = base\_p + ((col < width) ? col : (width -\/ 1)) * comp;}
\DoxyCodeLine{1921               \textcolor{keywordtype}{float} r = dataR[p], g = dataG[p], b = dataB[p];}
\DoxyCodeLine{1922               Y[pos] = +0.29900f * r + 0.58700f * g + 0.11400f * b -\/ 128;}
\DoxyCodeLine{1923               U[pos] = -\/0.16874f * r -\/ 0.33126f * g + 0.50000f * b;}
\DoxyCodeLine{1924               V[pos] = +0.50000f * r -\/ 0.41869f * g -\/ 0.08131f * b;}
\DoxyCodeLine{1925             \}}
\DoxyCodeLine{1926           \}}
\DoxyCodeLine{1927 }
\DoxyCodeLine{1928           DCY = stbiw\_\_jpg\_processDU(s, \&bitBuf, \&bitCnt, Y, 8, fdtbl\_Y, DCY,}
\DoxyCodeLine{1929                                      YDC\_HT, YAC\_HT);}
\DoxyCodeLine{1930           DCU = stbiw\_\_jpg\_processDU(s, \&bitBuf, \&bitCnt, U, 8, fdtbl\_UV, DCU,}
\DoxyCodeLine{1931                                      UVDC\_HT, UVAC\_HT);}
\DoxyCodeLine{1932           DCV = stbiw\_\_jpg\_processDU(s, \&bitBuf, \&bitCnt, V, 8, fdtbl\_UV, DCV,}
\DoxyCodeLine{1933                                      UVDC\_HT, UVAC\_HT);}
\DoxyCodeLine{1934         \}}
\DoxyCodeLine{1935       \}}
\DoxyCodeLine{1936     \}}
\DoxyCodeLine{1937 }
\DoxyCodeLine{1938     \textcolor{comment}{// Do the bit alignment of the EOI marker}}
\DoxyCodeLine{1939     stbiw\_\_jpg\_writeBits(s, \&bitBuf, \&bitCnt, fillBits);}
\DoxyCodeLine{1940   \}}
\DoxyCodeLine{1941 }
\DoxyCodeLine{1942   \textcolor{comment}{// EOI}}
\DoxyCodeLine{1943   stbiw\_\_putc(s, 0xFF);}
\DoxyCodeLine{1944   stbiw\_\_putc(s, 0xD9);}
\DoxyCodeLine{1945 }
\DoxyCodeLine{1946   \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{1947 \}}
\DoxyCodeLine{1948 }
\DoxyCodeLine{1949 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_jpg\_to\_func(stbi\_write\_func *func, \textcolor{keywordtype}{void} *context, \textcolor{keywordtype}{int} x,}
\DoxyCodeLine{1950                                     \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp, \textcolor{keyword}{const} \textcolor{keywordtype}{void} *data,}
\DoxyCodeLine{1951                                     \textcolor{keywordtype}{int} quality) \{}
\DoxyCodeLine{1952   stbi\_\_write\_context s = \{0\};}
\DoxyCodeLine{1953   stbi\_\_start\_write\_callbacks(\&s, func, context);}
\DoxyCodeLine{1954   \textcolor{keywordflow}{return} stbi\_write\_jpg\_core(\&s, x, y, comp, (\textcolor{keywordtype}{void} *)data, quality);}
\DoxyCodeLine{1955 \}}
\DoxyCodeLine{1956 }
\DoxyCodeLine{1957 \textcolor{preprocessor}{\#ifndef STBI\_WRITE\_NO\_STDIO}}
\DoxyCodeLine{1958 STBIWDEF \textcolor{keywordtype}{int} stbi\_write\_jpg(\textcolor{keywordtype}{char} \textcolor{keyword}{const} *filename, \textcolor{keywordtype}{int} x, \textcolor{keywordtype}{int} y, \textcolor{keywordtype}{int} comp,}
\DoxyCodeLine{1959                             \textcolor{keyword}{const} \textcolor{keywordtype}{void} *data, \textcolor{keywordtype}{int} quality) \{}
\DoxyCodeLine{1960   stbi\_\_write\_context s = \{0\};}
\DoxyCodeLine{1961   \textcolor{keywordflow}{if} (stbi\_\_start\_write\_file(\&s, filename)) \{}
\DoxyCodeLine{1962     \textcolor{keywordtype}{int} r = stbi\_write\_jpg\_core(\&s, x, y, comp, data, quality);}
\DoxyCodeLine{1963     stbi\_\_end\_write\_file(\&s);}
\DoxyCodeLine{1964     \textcolor{keywordflow}{return} r;}
\DoxyCodeLine{1965   \} \textcolor{keywordflow}{else}}
\DoxyCodeLine{1966     \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{1967 \}}
\DoxyCodeLine{1968 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{1969 }
\DoxyCodeLine{1970 \textcolor{preprocessor}{\#endif }\textcolor{comment}{// STB\_IMAGE\_WRITE\_IMPLEMENTATION}}
\DoxyCodeLine{1971 }
\DoxyCodeLine{1972 \textcolor{comment}{/* Revision history}}
\DoxyCodeLine{1973 \textcolor{comment}{      1.16  (2021-\/07-\/11)}}
\DoxyCodeLine{1974 \textcolor{comment}{             make Deflate code emit uncompressed blocks when it would otherwise}}
\DoxyCodeLine{1975 \textcolor{comment}{   expand support writing BMPs with alpha channel 1.15  (2020-\/07-\/13) unknown}}
\DoxyCodeLine{1976 \textcolor{comment}{      1.14  (2020-\/02-\/02) updated JPEG writer to downsample chroma channels}}
\DoxyCodeLine{1977 \textcolor{comment}{      1.13}}
\DoxyCodeLine{1978 \textcolor{comment}{      1.12}}
\DoxyCodeLine{1979 \textcolor{comment}{      1.11  (2019-\/08-\/11)}}
\DoxyCodeLine{1980 \textcolor{comment}{}}
\DoxyCodeLine{1981 \textcolor{comment}{      1.10  (2019-\/02-\/07)}}
\DoxyCodeLine{1982 \textcolor{comment}{             support utf8 filenames in Windows; fix warnings and platform ifdefs}}
\DoxyCodeLine{1983 \textcolor{comment}{      1.09  (2018-\/02-\/11)}}
\DoxyCodeLine{1984 \textcolor{comment}{             fix typo in zlib quality API, improve STB\_I\_W\_STATIC in C++}}
\DoxyCodeLine{1985 \textcolor{comment}{      1.08  (2018-\/01-\/29)}}
\DoxyCodeLine{1986 \textcolor{comment}{             add stbi\_\_flip\_vertically\_on\_write, external zlib, zlib quality,}}
\DoxyCodeLine{1987 \textcolor{comment}{   choose PNG filter 1.07  (2017-\/07-\/24) doc fix 1.06 (2017-\/07-\/23) writing JPEG}}
\DoxyCodeLine{1988 \textcolor{comment}{   (using Jon Olick's code) 1.05   ??? 1.04 (2017-\/03-\/03) monochrome BMP}}
\DoxyCodeLine{1989 \textcolor{comment}{   expansion 1.03   ??? 1.02 (2016-\/04-\/02) avoid allocating large structures on}}
\DoxyCodeLine{1990 \textcolor{comment}{   the stack 1.01 (2016-\/01-\/16) STBIW\_REALLOC\_SIZED: support allocators with no}}
\DoxyCodeLine{1991 \textcolor{comment}{   realloc support avoid race-\/condition in crc initialization minor compile}}
\DoxyCodeLine{1992 \textcolor{comment}{   issues 1.00 (2015-\/09-\/14) installable file IO function 0.99 (2015-\/09-\/13)}}
\DoxyCodeLine{1993 \textcolor{comment}{             warning fixes; TGA rle support}}
\DoxyCodeLine{1994 \textcolor{comment}{      0.98 (2015-\/04-\/08)}}
\DoxyCodeLine{1995 \textcolor{comment}{             added STBIW\_MALLOC, STBIW\_ASSERT etc}}
\DoxyCodeLine{1996 \textcolor{comment}{      0.97 (2015-\/01-\/18)}}
\DoxyCodeLine{1997 \textcolor{comment}{             fixed HDR asserts, rewrote HDR rle logic}}
\DoxyCodeLine{1998 \textcolor{comment}{      0.96 (2015-\/01-\/17)}}
\DoxyCodeLine{1999 \textcolor{comment}{             add HDR output}}
\DoxyCodeLine{2000 \textcolor{comment}{             fix monochrome BMP}}
\DoxyCodeLine{2001 \textcolor{comment}{      0.95 (2014-\/08-\/17)}}
\DoxyCodeLine{2002 \textcolor{comment}{             add monochrome TGA output}}
\DoxyCodeLine{2003 \textcolor{comment}{      0.94 (2014-\/05-\/31)}}
\DoxyCodeLine{2004 \textcolor{comment}{             rename private functions to avoid conflicts with stb\_image.h}}
\DoxyCodeLine{2005 \textcolor{comment}{      0.93 (2014-\/05-\/27)}}
\DoxyCodeLine{2006 \textcolor{comment}{             warning fixes}}
\DoxyCodeLine{2007 \textcolor{comment}{      0.92 (2010-\/08-\/01)}}
\DoxyCodeLine{2008 \textcolor{comment}{             casts to unsigned char to fix warnings}}
\DoxyCodeLine{2009 \textcolor{comment}{      0.91 (2010-\/07-\/17)}}
\DoxyCodeLine{2010 \textcolor{comment}{             first public release}}
\DoxyCodeLine{2011 \textcolor{comment}{      0.90   first internal release}}
\DoxyCodeLine{2012 \textcolor{comment}{*/}}
\DoxyCodeLine{2013 }
\DoxyCodeLine{2014 \textcolor{comment}{/*}}
\DoxyCodeLine{2015 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{2016 \textcolor{comment}{This software is available under 2 licenses -\/-\/ choose whichever you prefer.}}
\DoxyCodeLine{2017 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{2018 \textcolor{comment}{ALTERNATIVE A -\/ MIT License}}
\DoxyCodeLine{2019 \textcolor{comment}{Copyright (c) 2017 Sean Barrett}}
\DoxyCodeLine{2020 \textcolor{comment}{Permission is hereby granted, free of charge, to any person obtaining a copy of}}
\DoxyCodeLine{2021 \textcolor{comment}{this software and associated documentation files (the "{}Software"{}), to deal in}}
\DoxyCodeLine{2022 \textcolor{comment}{the Software without restriction, including without limitation the rights to}}
\DoxyCodeLine{2023 \textcolor{comment}{use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies}}
\DoxyCodeLine{2024 \textcolor{comment}{of the Software, and to permit persons to whom the Software is furnished to do}}
\DoxyCodeLine{2025 \textcolor{comment}{so, subject to the following conditions:}}
\DoxyCodeLine{2026 \textcolor{comment}{The above copyright notice and this permission notice shall be included in all}}
\DoxyCodeLine{2027 \textcolor{comment}{copies or substantial portions of the Software.}}
\DoxyCodeLine{2028 \textcolor{comment}{THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR}}
\DoxyCodeLine{2029 \textcolor{comment}{IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,}}
\DoxyCodeLine{2030 \textcolor{comment}{FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE}}
\DoxyCodeLine{2031 \textcolor{comment}{AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER}}
\DoxyCodeLine{2032 \textcolor{comment}{LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,}}
\DoxyCodeLine{2033 \textcolor{comment}{OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE}}
\DoxyCodeLine{2034 \textcolor{comment}{SOFTWARE.}}
\DoxyCodeLine{2035 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{2036 \textcolor{comment}{ALTERNATIVE B -\/ Public Domain (www.unlicense.org)}}
\DoxyCodeLine{2037 \textcolor{comment}{This is free and unencumbered software released into the public domain.}}
\DoxyCodeLine{2038 \textcolor{comment}{Anyone is free to copy, modify, publish, use, compile, sell, or distribute this}}
\DoxyCodeLine{2039 \textcolor{comment}{software, either in source code form or as a compiled binary, for any purpose,}}
\DoxyCodeLine{2040 \textcolor{comment}{commercial or non-\/commercial, and by any means.}}
\DoxyCodeLine{2041 \textcolor{comment}{In jurisdictions that recognize copyright laws, the author or authors of this}}
\DoxyCodeLine{2042 \textcolor{comment}{software dedicate any and all copyright interest in the software to the public}}
\DoxyCodeLine{2043 \textcolor{comment}{domain. We make this dedication for the benefit of the public at large and to}}
\DoxyCodeLine{2044 \textcolor{comment}{the detriment of our heirs and successors. We intend this dedication to be an}}
\DoxyCodeLine{2045 \textcolor{comment}{overt act of relinquishment in perpetuity of all present and future rights to}}
\DoxyCodeLine{2046 \textcolor{comment}{this software under copyright law.}}
\DoxyCodeLine{2047 \textcolor{comment}{THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR}}
\DoxyCodeLine{2048 \textcolor{comment}{IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,}}
\DoxyCodeLine{2049 \textcolor{comment}{FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE}}
\DoxyCodeLine{2050 \textcolor{comment}{AUTHORS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN}}
\DoxyCodeLine{2051 \textcolor{comment}{ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION}}
\DoxyCodeLine{2052 \textcolor{comment}{WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.}}
\DoxyCodeLine{2053 \textcolor{comment}{-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{2054 \textcolor{comment}{*/}}

\end{DoxyCode}
